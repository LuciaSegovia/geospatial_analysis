[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Reproducible documentation",
    "section": "",
    "text": "Preface",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#about-this-book",
    "href": "index.html#about-this-book",
    "title": "Reproducible documentation",
    "section": "About this book",
    "text": "About this book\nThe data files needed to reproduce this analysis can be obtained from:\n\nDHS Program\nKumssa et al. (2022) & Chilimba et al. (2011).\nMalawi Boundaries\n\n\nEnumeration Areas\nDistricts\n\nThe scripts for processing the raw data for modelling are those staring with “00_” while data processing are those files starting with “01_”, the model itself is run by the “02_”. The scritps should be run in the following order.\n\n00_cleaning-dhs.R\n00_cleaning-maize.R\n00_cleaning-boundaries.R\n00_cleaning-locations.R\n01_maize-model.R\n01_maize-aggregation.R\n01_combining-data.R\n02_inla-loop.R",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "index.html#acknowledgements",
    "href": "index.html#acknowledgements",
    "title": "Reproducible documentation",
    "section": "Acknowledgements",
    "text": "Acknowledgements\n\n\n\n\nChilimba, Allan D. C., Scott D. Young, Colin R. Black, Katie B. Rogerson, E. Louise Ander, Michael J. Watts, Joachim Lammel, and Martin R. Broadley. 2011. “Maize Grain and Soil Surveys Reveal Suboptimal Dietary Selenium Intake Is Widespread in Malawi.” Scientific Reports 1 (1, 1): 72. https://doi.org/10.1038/srep00072.\n\n\nKumssa, D. B., A. W. Mossa, T. Amede, E. L. Ander, E. H. Bailey, L. Botoman, C. Chagumaira, et al. 2022. “Cereal Grain Mineral Micronutrient and Soil Chemistry Data from GeoNutrition Surveys in Ethiopia and Malawi.” Scientific Data 9 (1, 1): 443. https://doi.org/10.1038/s41597-022-01500-5.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Introduction",
    "section": "",
    "text": "Aim of the study\n\nAt what level of spatial aggregation of maize Se concentration, plasma Se concentration was better explained/described, after accounting for individual-level factors of plasma Se concentration variability?\nTo confirm that prediction of maize Se concentration provides more accurate estimates when compared with plasma Se concentration in women in Malawi.\n\n\n\nObjectives\nThe objectives of these documentation and the exploratory analysis are:\n\nto document the cleaning steps and decision made that may influence the analysis and subsequent results.\nto evaluate the different variables that will be used in the analysis\nto document and calculate the mean/median maize Se concentration at different level of spatial aggregation (i.e., from 10km radius up to district averages).",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "data-description.html",
    "href": "data-description.html",
    "title": "1  Methods: Datasets & Variables",
    "section": "",
    "text": "1.1 Plasma Se concentration and other biological data\nIn this section we describe the data sets and variables that were evaluated for use in the study: “Plasma selenium concentrations are associated with spatial variation in maize selenium concentrations in Malawi; implications for assessing dietary selenium adequacy”. We provide information about the data provenance and the reasons for inclusion/exclusion of data sets in the analysis.\nGeo-referenced biomarker and other information for women (15-45 yo) was obtained from the Malawi DHS - MNS 2015-2016 ([Malawi] and ICF (2017)). Access need to be requested to DHS data here.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Methods: Datasets & Variables</span>"
    ]
  },
  {
    "objectID": "data-description.html#plasma-se-concentration-and-other-biological-data",
    "href": "data-description.html#plasma-se-concentration-and-other-biological-data",
    "title": "1  Methods: Datasets & Variables",
    "section": "",
    "text": "1.1.0.1 Micronutrient survey data\nThis data set (MW_WRA) provided information on biomarkers and other biological data for women of reproductive age in Malawi. The recode and all information about the variable description can be found here. Here’s the selection of variables that were considered for cleaning and exploration.\n\nmregion (region) [1-3 = N-&gt;S]\nmtype (urban/rural) [U-R = 1-2]\nm04 (gender)\nmcluster (cluster number - PSU)\nmnumber (household number - SSU)\nmweight (Micronutrient survey household weight (6 decimals))\nm01 (line number - individual ID within HH)\nm07 (age) (age in years)\nm435 (weight, in kg)\nm436 (height, in m)\nsel (Plasma Se (ng/ml))\nm415 (Took any kind of vitamin or mineral tablet/syrup/powder)\nm431 (Malaria test result)[^1]\nagp_crp_c1 (ANY_INFLAMMATION, Any inflammation (AGP &gt;1 g/L or CRP &gt;5 mg/L)\nagp (AGP ’Alpha-1-Acid Glycoprotein (g/L), (inflammation biomarker))\ncrp (CRP C-Reactive Protein (mg/L), (inflammation biomarker))\n\n[^1] Malaria test recode: Final result of malaria from blood smear test\n\n2 = Negative (in recode manual = 0)\n1 = Positive (1)\n6 = Test undetermined (4)\n7 = Sample not found in lab database (6)\n9 = Missing (m)\n(na) = Not applicable\n\n\n\n1.1.0.2 Women questionnaire data\nThis data set (MWIR7) provided individual-level information for women (15-49yo) on socioeconomic factors for the main DHS survey. We downloaded both the .dat and .dta file because the file with .dat extension was not opening in R. It was not corrupted as we could open the .MAP with Notepad+, and we could see all recode documentation.\nThese variables provide information at individual level and, below are the variables of interest:\n\nv101/V024 (De facto region of residence)\nsdist (district)\nv022 (survey strata)[^2]\nv005 (Woman’s sample weights)[^3]\nv106 (Highest educational level)\nv155 (Literacy)\nv190 (Wealth index) [1-5 (lowest to highest)]\nv190a (Wealth index for urban/rural)\nv002 (Household number)\nv001 (Cluster number)\nv463a (is_smoker, Only cover cigarettes (other smoking variables))\nm420 (had_malaria)\nv150 (Relationship to household head)\n\n[^2]Note that v022 & v023 are strata Urban/rural district as the information collected here was for the whole DHS survey. This should not be used for MNS because it is a subset of the DHS survey with the representatives (and strata) in at region+rural/urban. We could create our own strata based on the survey design (1/6 (3regions*2urban/rural)).\n[^3]Similarly to the above this variable is not to be used for MNS, as MNS is a subset and has its own survey weights. For the DHS, it needs to be divided by 1000000 before applying the weighting factor.\n\n\n1.1.0.3 Location data\nThe data file (MWGE7AFL) provides information on GPS coordinates (displaced) for each cluster (PSU = EA) in the main DHS (2015-2016) survey. Hence, all the households in the same EA/cluster have the same (GPS) location.\nThe variable used for merging is DHSCLUST (to be merged with V001).\nNote that GPS displacement is true within district. Also, according to the documentation the cluster “centre” recorded is the “center of the populated place in the cluster” (MWGE7AFL/GPS_Displacement_README.txt, DHS, 2014).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Methods: Datasets & Variables</span>"
    ]
  },
  {
    "objectID": "data-description.html#geo-referenced-crop-maize-composition-se-concentration-data-in-malawi",
    "href": "data-description.html#geo-referenced-crop-maize-composition-se-concentration-data-in-malawi",
    "title": "1  Methods: Datasets & Variables",
    "section": "1.2 Geo-referenced crop (maize) composition (Se concentration) data in Malawi",
    "text": "1.2 Geo-referenced crop (maize) composition (Se concentration) data in Malawi\n\n1.2.0.1 Main dataset: GeoNutrition\nThis data set provides geo-referenced data on the concentration of Se (and other minerals) in maize (and other crops) in Malawi as well as soil pH (measured in water) for each sampling site. The data was collected from April to June 2018 in Malawi and it aimed to be representative of the agricultural land in the country. The data set can be obtained from this open repository, and it is further described by Kumssa et al. (2022) & Gashu et al, (2021). We decided to use this data set instead of the one reported in the repository accompanying Gashu and colleagues study (2021) (see excluded data sources below) because it provided the raw data (i.e., including below detection limit values), as well as more metadata. For instance, it provided information on the limit of detection for each round of the Inductively Coupled Plasma (ICP). And, in particularly for Se analysis which were performed with the ICP - Mass Spectrometry (MS) separately due to the small amounts found in Malawi.\nThe data repository contains a number of data files for Malawi:\n\nRaw crop mineral dataset (MWI_CropSoilData_Raw), which provides the raw values, as extracted from the analytical device (i.e, data from the ICP without any further processing).\nProcessed crop mineral dataset (MWI_CropSoilData_NA), which has transformed values for not analysed (NM), below the limit of detection (BLOD), or negative values into NA.\nLimit of detection dataset (MWI_Crop_LOD_ByICPRun), provides information about the limit of detection per each round of ICP.\n\nThe main variable extracted from the main dataset (“MWI_CropSoilData_Raw.csv”) was: Se_grain which contain the information on Selenium (mg kg-1 DM) for all grain types.\nFile name: data/maize/MWI_CropSoilChemData_CSV/MWI_CropSoilData_Raw.csv\nFile name: data/maize/MWI_CropSoilChemData_CSV/MWI_Crop_LOD_ByICPRun.csv\n\n\n1.2.0.2 Complementary dataset: Chilimba\nMalawi maize grain and soil Se concentration data collected between 2009-2010 in the study of Chilimba et al. (2011). The data used was obtained from the co-authors of the manuscript (E.L.A.) which included the values of pH (in water) of the soil where samples were collected. However, the analyses outlined here can be performed using the publicly available version in here.\nThis data set was mainly included to supplement the data on maize grain Se concentration in Southern Malawi. Note that no information regarding limit of detection were provided, and that data collection and data analysis were done at different time and by a different team.\nFile name: data/maize/AllanChilimbaFieldData_forLucia_20230615.xlsx\n\n\n1.2.0.3 List of the excluded sources of data\nHere we present a list of data sets containing geo-referenced maize grain Se concentration information in Malawi that were evaluated and excluded from the final analyses. The cleaning script can be found in the exlcuded folder as 00_cleaning_excluded.R. More details on the reasons for exclusion are found in Section 4.3.\n\nMalawi maize grain and soil Se concentration dataset (2018). It is publicly available here.\n\nFile name: GeoNutrition/Soil_Crop_comparisons/Malawi/Malawi_grain_soil.xlsx\n\nMalawi crops, including maize, mineral concentration data set (2012-2013) and soil pH. This data was collected by Joy and colleagues (2014), and it is publicly available here in the Supplemantary table. Tabs:1-10: Explored in this analysis:\n\n\nSTable6: crop sample info (maize Se) and coordinates\nSTable5: Soil samples (soil pH)\nSTable10: Information on each crop and its corresponding soil sample (Sample_number, Soil_sample).\n\nFile re-name: data/maize/2012_Joy-mwi-samples.xlsx",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Methods: Datasets & Variables</span>"
    ]
  },
  {
    "objectID": "data-description.html#sec-bound",
    "href": "data-description.html#sec-bound",
    "title": "1  Methods: Datasets & Variables",
    "section": "1.3 Boundaries of Malawi",
    "text": "1.3 Boundaries of Malawi\nMalawi administrative boundaries are, from the largest to smallest area: Region&gt; District&gt; Traditional Authorities (TA)&gt; Enumeration Areas (EA). We are mainly interested in Districts and EAs for our study. Other boundaries in Malawi that were explored included: agro-ecological zones, agricultural land, water bodies, national parks, etc.\nWe excluded Agro-Ecological Zones (AEZs) boundaries from our study because there are only 4 AEZs in Malawi, hence areas are too large to get any meaningful spatial pattern, and/or level of aggregation.\nNote: The AEZs shape files can be found in the Scoping review (R project, data folder), and further information can be found in here.\nInformation of the boundaries were found from difference sources and data owners. Here’s a list of the boundaries we explored and the reasons for inclusion/ exclusion.\n\n1.3.0.1 Main administrative boudaries file\n\nMalawi NSO from HDX (Humanitarian datasets) (mwi_adm_nso_hotosm_20230329). This source only have up to Admin2 (District) level.\n\nFile: mwi-boundaries/mwi_adm_nso_hotosm_20230329_shp/mwi_admbnda_adm3_nso_hotosm_20230329.shp\n\nPopulation over Enumeration Areas NSO, (eas_bnd): this layer shows the distribution of the population over the country of Malawi on the basis of enumeration area boundary. Data producer is the National Statistical Office.\n\nFile: mwi-boundaries/EN_NSO/eas_bnd.shp\n\n\n1.3.0.2 Excluded boudaries files\n\nGADM maps and data (gadm40_MWI_shp): The file for the EAs has some issues that led to some data points falling into the lake. Hence, we found a different file with the Malawi boundaries. This is because some of the EAs near the lake has some “ownership” over certain areas of the lake, which were included in the boundaries of those EAs in the shapefile (i.e., as a continuum from land to lake).\nEcho2 prioritization, these files covered up to EAs. (depricated - Updated version: Population over Enumeration Areas NSO).\nGeoBoundaries: It also has 3 level of boudaries: 1-region, 2-district, 3-TA. These files has no EA boundaries (deprecated).\n\nOther excluded boundaries: Agro-Ecological Zones, Traditional Authorities (more information on data exploration: Chapter 3).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Methods: Datasets & Variables</span>"
    ]
  },
  {
    "objectID": "data-description.html#covariates",
    "href": "data-description.html#covariates",
    "title": "1  Methods: Datasets & Variables",
    "section": "1.4 Covariates",
    "text": "1.4 Covariates\n\n1.4.0.1 Fish intake proxy\nFish intake has been identified as one of the main sources of Se in Malawian diets (REF, REF, REF), and it may be a key determinant for plasma Se status in Malawi. Hence, as fish intake proxy, we decided to use some measurement of the distance to inland water bodies, as suggested by other studies. We tested three approaches:\n\nDistance to inland water bodies in Malawi: Following the study from O’Meara et al, (2021), and using the raster layer developed by WorldPop and that can be accessed here.\nDistance to Lake Malawi: Following the study fro Phiri et al, (2019), and using distance to Lake Malawi. We used the shape files of Malawi (ea_bnd) described in Section 1.3, and calculated the Euclidean distance from the DHS cluster centroids to the Lake.\nDistance to main Lakes: We decided to use a mixed approach between the other two, where we used the shortest distance to one of the three main lakes in Malawi: Lake Chilwa, Lake Malombe and Lake Malawi. As they have been shown to be fishing ground in Malawi. For instance, while lake Malawi provides the largest volume of fish, it is followed by lake Chilwa which provides around 20% of the total fish landings in Malawi (Chiwaula et al., 2012, Simmance et al, 2021). We calculate the closest distance to the closest lake using the same boundary file as described above.\n\n\n\n1.4.0.2 Excluded\nThere were some covariate data sets that we explored but that were excluded from the study.\nMean Annual Temperature (MAT) was obtained as a raster data set (mwi_CHELSA_bio10_1.tif) from the CHELSA data set (CHELSA_bio10_1.tif), which is a worldwide from 1979-2013 high resolution MAT raster layer, the original data was extracted from the here as GEOtiff format. Then, the data set was cropped (clipped) from the global to Malawi country area. The clipping was done on QGIS version (3.28.3) Firenze using the enumeration area shapefile (ea_bnd layer) as reference extend for clipping. The geographic coordinate system are referenced to the WGS 84 horizontal datum, with the horizontal coordinates expressed in decimal degrees.\nReplicating Sequence: Raster&gt;Extraction&gt;Clip Raster by Extend…&gt;Clipping extent&gt;Calculate from a layer&gt; ea_bnd.\nThis variable was planned to be used as environmental covariate for the geospatial Se maize model (BIO1) however following the method published by Gashu et al (2020), no covariates were used for the maize grain Se predictions.\nDistance to water bodies in Malawi\n\nGLOBAL LAKES AND WETLANDS DATABASE (GLWD): Following the study from O’Meara et al., (2021), we obtained the Level 2 (GLWD-2) which comprises the shoreline polygons of permanent open water bodies with a surface area ≥ 0.1 km2 excluding the water bodies contained in GLWD-1. The approximate 250,000 polygons of GLWD-2 are attributed as lakes, reservoirs and rivers (World Wildlife Fund, 2019). We excluded this data set because a) it was a bit old (2004), and seemed that some of the files were corrupted.\nESACCIL (Lamarche et al. (2017)): This data set contains the boundaries of each water body in Malawi, and was superseded by the raster layer on distance to inland water bodies in Malawi generated by WorldPop. We explored the data and calculated the distance to the DHS centroid, however the harmonised Worldpop dataset method to calculate distance for each pixel was more robust. The shapefiles with the world inland water bodies was accessed from here, and then cropped to Malawi.\n\n\n\n1.4.1 Geo-referenced apparent food consumption in Malawi (Se intake)\nThis dataset the Fourth Integrated Household Survey 2016-2017, was only used as support information. It can be accessed through the World Bank microdata website. Information about each module and the information contained can be found here.\nCleaning script, summary statistics and plots can be found in the repository ihs4, under the MAPS project.\nFile of interest & variables:\n\nFood consumption\nGeographic data (HouseholdGeovariablesIHS4.csv). This dataset has information on the displaced coordinates of each household, distance to some features (road, population centre, agricultural market, etc), and other enviromental variables (elevation, rainfall, etc).\n\nVariables of interest:\n\ncase_id: Unique Household Identifier\nHHID: household id (Survey Solutions Unique HH Identifier)\nlat_modified: GPS Latitude Modified\nlon_modified: GPS Longitude Modified\ndist_road: HH Distance in (KMs) to Nearest Road\ndist_agmrkt: HH Distance in (KMs) to Nearest Agricultural Market\nssa_aez09: Agro-ecological Zones\nsrtm_1k: Elevation (m)\n\n\nSales vs stored crops (rainy season) (AG_MOD_I)\nSales vs stored crops (dry (dimba) season) (AG_MOD_O)\nSales vs stored trees (12months) (AG_MOD_Q)\n\n\n\n\n\nChilimba, Allan D. C., Scott D. Young, Colin R. Black, Katie B. Rogerson, E. Louise Ander, Michael J. Watts, Joachim Lammel, and Martin R. Broadley. 2011. “Maize Grain and Soil Surveys Reveal Suboptimal Dietary Selenium Intake Is Widespread in Malawi.” Scientific Reports 1 (1, 1): 72. https://doi.org/10.1038/srep00072.\n\n\nKumssa, D. B., A. W. Mossa, T. Amede, E. L. Ander, E. H. Bailey, L. Botoman, C. Chagumaira, et al. 2022. “Cereal Grain Mineral Micronutrient and Soil Chemistry Data from GeoNutrition Surveys in Ethiopia and Malawi.” Scientific Data 9 (1, 1): 443. https://doi.org/10.1038/s41597-022-01500-5.\n\n\nLamarche, Céline, Maurizio Santoro, Sophie Bontemps, Raphaël d’Andrimont, Julien Radoux, Laura Giustarini, Carsten Brockmann, Jan Wevers, Pierre Defourny, and Olivier Arino. 2017. “Compilation and Validation of SAR and Optical Data Products for a Complete and Global Map of Inland/Ocean Water Tailored to the Climate Modeling Community.” Remote Sensing 9 (1): 36.\n\n\n[Malawi], National Statistical Office (NSO), and ICF. 2017. “Malawi Demographic and Health Survey 2015-16.” https://dhsprogram.com/pubs/pdf/FR319/FR319.pdf.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Methods: Datasets & Variables</span>"
    ]
  },
  {
    "objectID": "data-dhs.html",
    "href": "data-dhs.html",
    "title": "2  Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)",
    "section": "",
    "text": "2.1 Micronutrient survey data\nIn this and subsequent sections, we explore the datasets and variables that were included in our study.\nFirst we need to set up the environment and load the data described in the previous section.\nIn this section, we are loading and exploring the Malawi MNS-DHS (205-2016) ([Malawi] and ICF (2017)).\nFirstly, we loaded the data (MW_WRA) which contains the plasma Se concentration and other biomarker data in women in Malawi.\nCode\n# Biomarkers data DHS (00_cleaning-dhs, line 25)\nMalawi_WRA &lt;- haven::read_dta(here::here(\"data\", \"MW_WRA.dta\"))\nThen, we are renaming the variables to a more “human-friendly” names, and selecting those that are going to be explored as potential confounders for plasma Se concentration.\nCode\n# Renaming variables \nMalawi_WRA &lt;- Malawi_WRA %&gt;% \n  dplyr::rename(\n  ferritin='fer',\n  region='mregion',\n  sex = \"m04\", \n  zinc='zn_gdl',\n  dretinol='incap_dr',\n  retinol='incap_retinol',\n  urbanity='mtype',\n  MRDR='mrdr_ratio',\n  survey_cluster1='mcluster',\n  household_id1='mnumber',\n  survey_weight=\"mweight\",\n  LINENUMBER='m01',\n  AGE_IN_YEARS='m07',\n  SALT_PRESENT='m12',\n  SALT_LABEL_IODIZED='m104',\n  OIL_PRESENT='m110',\n  OIL_FORTIFIED='m112',\n  IRON_LWEEK='m414',\n  supple ='m415', # took any supplements\n  FEVER24='m417',\n  HEMOGLOBIN_LAB='m432',\n  Malaria_test_result='m431',\n  WEIGHT='m435',\n  HEIGHT='m436',\n  is_pregnant='preg',\n  agp_HIGH='agp_c1',\n  crp_HIGH='crp_c1',\n  ANY_INFLAMMATION='agp_crp_c1',\n  ANEMIA_ADJUSTED='anemia',\n  SFER_microg_L_ADJUSTED_INTERNAL='sf_reg',\n  LOW_SFER_microg_L_UNADJUSTED='sf_c2',\n  LOW_SFER_microg_L_ADJUSTED='sf_c1',\n  VITA_CONTENT_OIL='oil_vita',\n  VITA_CONTENT_SUGAR='sugar_vita',\n  IODINE_SALT='salt',\n  was_fasting='fast',\n  ps_folate='fol',\n  rbc_folate='rbcf',\n  iodine='iod',\n  selenium='sel',\n  vitamin_b12_gr='vitb12', \n  time_of_day_sampled2= \"m430h\", \nhad_fever='m416',\nhad_diarrhea= 'm419',\nhad_malaria= 'm420') \n\n# Selecting variables of interest:\n\nMalawi_WRA &lt;- Malawi_WRA %&gt;% dplyr::select(region, sex , crp,  agp, urbanity, survey_cluster1,\nhousehold_id1, survey_weight, LINENUMBER, AGE_IN_YEARS, supple, # took any supplements\nMalaria_test_result, WEIGHT, HEIGHT, is_pregnant, selenium) \n\n# Formatting to factor\nMalawi_WRA &lt;- Malawi_WRA %&gt;% mutate_at(c(\"region\", \"urbanity\" ), as.factor)  \n\n# MNS Weight survey \nMalawi_WRA$wt  &lt;- Malawi_WRA$survey_weight/1000000\nThere are 802 entries for plasma Se in the dataset.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)</span>"
    ]
  },
  {
    "objectID": "data-dhs.html#sec-plasma",
    "href": "data-dhs.html#sec-plasma",
    "title": "2  Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)",
    "section": "",
    "text": "Summary Box\n\n\n\nSummary of the main cleaning assumptions/ decisions:\n\nAge: Included women with age outside the standard range of WRA (15-49yo).\nGender: One “male” was recoded as “female”\nPregnancy: Pregnant women and those recorded as NA were excluded.\nMalaria test recode: 2 (0) == Negative, 1 == Positive, all other NA.\n\n\n\n\n2.1.1 Age\nThere are some observations (n = 8) that are below the age range for WRA, and none above the range.\nIn addition, mean (and median) were higher in the northern region compared with southern and central regions (Figure 2.1). Whereas, mean/median age were higher in rural areas. We applied survey weights when calculating them.\n\n\nCode\n# Boxplot: Age per region and residency----\nvar_x &lt;- \"AGE_IN_YEARS\"\nx_label &lt;- \"Age (years)\"\n\nMalawi_WRA %&gt;% \n  mutate(region = forcats::fct_relevel(region,\"3\", \"2\", \"1\")) %&gt;% \n  ggplot(aes(x = !!sym(var_x), weight=wt, region, colour=urbanity)) +\n  geom_vline(xintercept = median(Malawi_WRA$AGE_IN_YEARS), col = \"lightgrey\", size = 1) +\n  geom_boxplot() + \n    scale_colour_manual(\"\", values = col_break, labels = lab_reside)+\n  #  geom_violin() + \n    coord_flip() +\n  scale_y_discrete(label = lab_region) +\n  theme_classic() +\n  labs(y = \"\",\n       x = x_label) +\n  theme(legend.position = \"top\")\n\n\n\n\n\n\n\n\nFigure 2.1: Age (in years) of women by residency and region in Malawi. The light grey line is the median age (years) for Malawi\n\n\n\n\n\n\n\n2.1.2 Gender & Pregnancy\nThere is one entry labelled as “male” while the data set should only contain women, and there were 60 women pregnant or with unknown status, which were excluded from the data set.\n\n\nCode\n# Excluding the pregnant women and unknown status\nMalawi_WRA  &lt;- subset(Malawi_WRA, is_pregnant==0 | is.na(is_pregnant)) \n\n\n\n\n2.1.3 Malaria test\nWe needed to recode other values than positive/ negative into NA, also we did not follow the recode manual (we are not putting 0 for negative, but keeping 2).\n\n\nCode\n# Recoding others values into NA \nMalawi_WRA$Malaria_test_result &lt;- ifelse(Malawi_WRA$Malaria_test_result==4| \n                                        Malawi_WRA$Malaria_test_result==6, \n                                         NA, Malawi_WRA$Malaria_test_result)\n\nMalawi_WRA$Malaria_test_result  &lt;- as.factor(Malawi_WRA$Malaria_test_result)\n\n\nThis variable has 22 missing values which would reduce the sample size. Hence, we need to evaluate whether the information provided would influence the results to decided whether to include this variable into the final model.\nCan we identify if malaria is influencing Se status? - In ?fig-XX, we can see the plasma Se concentration by malaria test result, and it didn’t seem to have many differences between positive and negative malaria test, but maybe due to the high number of negative tests (see Section 2.1.8).\nWe could run the model with and without the variable and see if there is any difference in the final results.\nInterestingly, younger women tented to test positive to malaria in central and southern regions, as shown in Figure 2.2, which may be producing a confounding effect between age/malaria test and Se status.\nDifferences in the prevalence of malaria by age in WRA in Malawi were reported in the Micronutrient DHS report (REF).\n\n\nCode\n## Age per malaria test and residency ----\nvar_x &lt;- \"AGE_IN_YEARS\"\nx_label &lt;- \"Age (years)\"\nvar_col &lt;- \"Malaria_test_result\"\ncol_lab &lt;- lab_malaria\n\nvalue_median &lt;- median(Malawi_WRA$AGE_IN_YEARS)\n\nMalawi_WRA %&gt;% \n  ggplot(aes(x = !!sym(var_x), weight=wt, # w/ survey weights\n             region, fill=!!sym(var_col))) +\n  geom_vline(xintercept = value_median, col = \"lightgrey\", size = 1) +\n  geom_boxplot() + \n   scale_fill_manual(\"\", values = col_binary, labels = col_lab)+\n    coord_flip() +\n  scale_y_discrete(label = lab_region) +\n  theme_classic() +\n  labs(y = \"\",\n       x = x_label) +\n  theme(legend.position = \"top\") +\n  theme(strip.text = element_text(size = 12),\n        axis.text.y = element_text(size = 12), \n        axis.text.x = element_text(size = 10))\n\n\n\n\n\n\n\n\nFigure 2.2: Age (in years) of women by malaria test and region in Malawi. The light grey line is the median age (years) for Malawi\n\n\n\n\n\n\n\n2.1.4 Supplementation\nSimilarly, as with the Malaria test, we found high number of missing values which would reduce the sample size by 28, and also only few reported consuming supplement (n=13), thus, we decided to exclude this variable.\n\n\n2.1.5 Height & Weight\nMissing values were coded as “999” for height and weight, we recoded to NA, according to the DHS documentation and recode standards reported in (ICF. 2018. Demographic and Health Surveys Standard Recode Manual for DHS7. The Demographic and Health Surveys Program. Rockville, Maryland, U.S.A.: ICF).\n\n\nCode\n# Height: Missing values (999 to NA)\nMalawi_WRA$HEIGHT[Malawi_WRA$HEIGHT &gt;999] &lt;- NA\n\n# Weight: Missing values (999 to NA)\nMalawi_WRA$WEIGHT[Malawi_WRA$WEIGHT &gt;999] &lt;- NA\n\n\n\nHeight: The height distribution was normal with two potential outliers (i.e., one woman with a recorded height of 100.2), after recoding the missing values.\nWeight: Some outliers were found as well, some weights were higher than expected, on the lower bound seems plausible given age and height.\n\n\n\n2.1.6 Body Mass Index\nWe calculated the Body Mass Index (BMI) as it would be added to the model as a proxy for total food consumption.\nWe hypothesised that women with higher food intake may have higher plasma Se due to higher overall dietary Se intake. For instance, a normal BMI range (i.e., 18.5-24.9 kg/\\(m^2\\)) would likely mean that the food intake was providing enough food (i.e, energy) to maintain a normal body weight.\nIn Malawi, main source of energy (and some micronutrient) is maize, as it is the main staple crop which supplies more than 60% of the total energy supply (REF-Joy et al, , REF). Hence, we are exploring the BMI as a potential proxy of difference in plasma Se concentration due to differences in maize total consumption.\n\n\nCode\n# Creating BMI variable\nMalawi_WRA$BMI&lt;- Malawi_WRA$WEIGHT/(Malawi_WRA$HEIGHT/100)^2\n\n\nAs expected, BMI also has some outliers due to the high weight of some women (Figure 2.3). We are not removing those values as the BMI is still plausible.\n\n\nCode\nsummaplot(Malawi_WRA$BMI)\n\n\n[1] 17  missing value(s) removed\n\n\nCode\n# Changing implausible to NA\n\nMalawi_WRA$BMI[Malawi_WRA$BMI&gt;300] &lt;- NA\n\n\n\n\n\n\n\n\nFigure 2.3: Distrubution of Body Mass Index (BMI) (kg/m^2) of women in Malawi\n\n\n\n\n\nWe could see that the northern region has overall higher BMI. This differences were only moderately significant when comparing the northern and the central region. Similar trend was found when we evaluated the wealth quintiles (Section 2.2.1), where the Northern region in Malawi has higher BMI & wealth quintile than the other two regions. This is unsurprising, as we can assume that BMI and wealth may be related, and it has been reported previously higher body weight in wealthier women in Malawi and in the region (REF, REF, REF).\nThere was a significant difference in the BMI between rural and urban women however, the number of urban were very low. Moreover, when we checked the results by region, the differences were only seeing for the southern region. These results should be interpret with care due to the difference in sample size between rural and urban.\nMoreover, as it can see in the scatter plot (Figure 2.4) and in the histogram, most of the population included in the study were within normal BMI range, and plasma Se concentration was not particularly influenced by BMI.\n\n\nCode\n# Scatter plot \nplot(selenium ~ BMI, Malawi_WRA)\n\n\n\n\n\n\n\n\nFigure 2.4: Scatter plot showing relationship between plasma Se concentration and BMI in women of reproductive age in Malawi.\n\n\n\n\n\n\n\n2.1.7 Selenium\nPlasma Se concentration is highly skewered, but when log-transformed it shows normality.\n\n\nCode\n# Distribution of plasma Se conc.\nsummaplot(Malawi_WRA$selenium)\n\n\n[1] 34  missing value(s) removed\n\n\n\n\n\n\n\n\n\nCode\n# Distribution of log-transformend plasma Se conc.\nsummaplot(log(Malawi_WRA$selenium))\n\n\n[1] 34  missing value(s) removed\n\n\n\n\n\n\n\n\n\nMoreover, when we see the distribution by region and residency, we can see that there are differences by regions (see Figure 2.5).\n\n\nCode\n# Ridges: Plasma Se per region and residency\n# Selecting the variable & the label\nvar_x &lt;- \"selenium\"\nx_label &lt;- plasma_lab\n  \nMalawi_WRA %&gt;% filter(!is.na(!!sym(var_x))) %&gt;% \n  mutate(region = forcats::fct_relevel(region,\"3\", \"2\", \"1\")) %&gt;% \n  ggplot(aes(x = !!sym(var_x),  region, fill=urbanity, colour = urbanity)) +\n  ggridges::geom_density_ridges(alpha = 0.5)  +\n    scale_fill_manual(\"\", values = col_break, labels = lab_reside)+\n  scale_colour_discrete( guide = \"none\") +\n  scale_y_discrete(label = lab_region) +\n  theme_classic() +\n  labs(y = \"\",\n       x = x_label) +\n  theme(legend.position = \"top\")\n\n\n\n\n\n\n\n\nFigure 2.5: Distribution of the plasma Se concentration (ng/mL) of women in Malawi by region and the colour represents the urbanicity (no survey weights applied).\n\n\n\n\n\nPlasma Se median values were higher in urban settings than in rural, and the highest in the Southern region.\n\n\nCode\n# Se Weighted mean/median by region\nddply(Malawi_WRA,~region, summarise,median=matrixStats::weightedMedian(selenium, wt,na.rm = T))\n\n\n  region   median\n1      1 73.68868\n2      2 71.07763\n3      3 80.76456\n\n\nThen, the median disaggregated by region and residency showed that Northern and Southern urban population had the highest plasma Se median concentration, while the Central region were the lowest, particularly for women living in rural settings as shown in Figure 2.6.\n\n\nCode\n# Se Weighted median by region & urbanity\nddply(Malawi_WRA,.(region, urbanity), summarise,median=matrixStats::weightedMedian(selenium, wt,na.rm = T))\n\n\n  region urbanity   median\n1      1        1 83.75346\n2      1        2 72.22663\n3      2        1 95.31994\n4      2        2 69.82099\n5      3        1 81.09410\n6      3        2 80.66016\n\n\nInterestingly, while the women in the Northern-urban areas had higher plasma Se than their southern counterpart, the women in the Southern-rural areas had higher plasma Se those in Northern-rural areas.\nIn addition, women who live in urban setting of the Central region had similar plasma Se median concentration as women in the northern region in rural settings.\n\n\nCode\ndata.df &lt;- Malawi_WRA %&gt;% dplyr::filter(!is.na(selenium))\n\ndata.df$survey_cluster1 &lt;- as.character(data.df$survey_cluster1)\ndata.df$urbanity &lt;- as.factor(data.df$urbanity)\n\n # Custom legend colour & labels\n col_break &lt;- c(\"1\" = \"#00BFC4\", \"2\" = \"#F8766D\")\n col_labels &lt;- c(\"1\" = \"Urban\", \"2\" = \"Rural\")\n unit_micro &lt;- expression(paste(\"Plasma Se conc. (ng  \",  mL^{-1}, \")\"))\n \nmicro_region(data.df, micro = selenium, var_sorting = survey_cluster1,\n             var_colouring = urbanity, unit_micro = unit_micro, label_sorting = \"Survey Cluster\", \n             col_break =col_break, col_labels = col_labels)\n\n# Custom X-axis labels \ncol_labels &lt;- c(\"Urban\", \"Rural\")\n\n\n\n\n\n\n\n\nFigure 2.6: Variation in plasma Se concentration (ng/mL) of women in Malawi by cluster. Information is divided by region and colour represents the urbanicity.\n\n\n\n\n\n\n\n2.1.8 Inflammation\nBoth CRP () and AGP () were measured in women, of which we had 13 and 13 missing values respectively. We can also see that both variables were skewered and hence, we needed to log-transform them, which turned them into normality.\n\n\nCode\n# Normality check\nsummaplot(data.df$crp)\n\n\n[1] 13  missing value(s) removed\n\n\n\n\n\n\n\n\n\nCode\nsummaplot(data.df$agp)\n\n\n[1] 13  missing value(s) removed\n\n\n\n\n\n\n\n\n\nCode\n# Normality check, after log-transformation\nsummaplot(log(data.df$crp))\n\n\n[1] 13  missing value(s) removed\n\n\n\n\n\n\n\n\n\nCode\nsummaplot(log(data.df$agp))\n\n\n[1] 13  missing value(s) removed\n\n\n\n\n\n\n\n\n\nThen, we checked values that were high (inflammation cut-offs: CRP &gt; 5 mg/L and/or AGP &gt; 1 g/L, REF-BRINDA, REF-DHS docu). From the total sample, after excluding women who were missing plasma Se concentration, only 69 women and 97 had CRP and AGP values that indicate inflammation. According to the 2015-2016 MDHS report, inflammation was reported around 12% but it was consistent across age groups, residency, and wealth quintiles.\nHowever, when we look at the CRP and AGP values by region, we can see in Figure 2.7 and ?fig-2_6b that CRP and AGP values were higher among those women who reported positive malaria tests. Interestingly, values in the southern region of Malawi were similarly high for both positive and negative malaria tests. This could be linked to the higher prevalence of other (infectious) diseases such as HIV.\nIt could be that this variable is correlated with Malaria, hence by including these two inflammation variables, we may be accounting for the potential influence of the malaria in the plasma Se.\n(AGP: 0.54 g/L and CRP: 0.16 mg/L, see Lou et al paper (BRINDA adjustement)\nHowever, malaria prevalence was higher in rural areas and for the different wealth quintiles (WQ), with lowest WQ being 6-times higher than the highest WQ. Since, these two variables may influence Plasma Se status we are including it in the model.\n\n\nCode\n## CRP per malaria test and residency ----\nvar_x &lt;- \"crp\"\nx_label &lt;- \"log-transformed CRP (mg/l)\"\ncut_off &lt;- log(5) #crp\nvar_col &lt;- \"Malaria_test_result\"\ncol_lab &lt;- lab_malaria\n\nvalue_median &lt;- log(median(pull(Malawi_WRA[,var_x]), na.rm = TRUE))\n\nMalawi_WRA %&gt;% \n  ggplot(aes(x = log(!!sym(var_x)), weight=wt, # w/ survey weights\n             region, fill=!!sym(var_col))) +\n  # CRP median (log-transformed) values\n  geom_vline(xintercept = value_median, col = \"lightgrey\", size = 1) +\n  # CRP cut off values for inflammation\n  geom_vline(xintercept = log(cut_off), col = \"red\", size = 1) +\n  geom_boxplot() + \n     scale_fill_manual(\"\", values = col_binary, labels = col_lab)+\n    coord_flip() +\n  scale_y_discrete(label = lab_region) +\n  theme_classic() +\n  labs(y = \"\",\n       x = x_label) +\n  theme(legend.position = \"top\") +\n  theme(strip.text = element_text(size = 12),\n        axis.text.y = element_text(size = 12), \n        axis.text.x = element_text(size = 10))\n\n\n\n\n\n\n\n\nFigure 2.7: Variation in c-reactive protein (CRP) (mg/L) (log-transformed) of women in Malawi by region and malaria test resutls. Grey line is the median CRP (log-transformed). Red line is the log-tranformed CRP cut-off value for infammation (5mg/L).\n\n\n\n\n\n\n\nCode\n## AGP per malaria test and residency ----\nvar_x &lt;- \"agp\"\nx_label &lt;- \"log-transformed AGP (g/l)\"\nx_label &lt;- \"log c-reactive protein (g/l)\"\ncut_off &lt;- log(1) #AGP\nvar_col &lt;- \"Malaria_test_result\"\ncol_lab &lt;- lab_malaria\n\nvalue_median &lt;- log(median(pull(Malawi_WRA[,var_x]), na.rm = TRUE))\n\nMalawi_WRA %&gt;% \n  ggplot(aes(x = log(!!sym(var_x)), weight=wt, # w/ survey weights\n             region, fill=!!sym(var_col))) +\n  geom_vline(xintercept = value_median, col = \"lightgrey\", size = 1) +\n  geom_vline(xintercept = log(5), col = \"red\", size = 1) +\n  geom_boxplot() + \n     scale_fill_manual(\"\", values = col_binary, labels = col_lab)+\n    coord_flip() +\n  scale_y_discrete(label = lab_region) +\n  theme_classic() +\n  labs(y = \"\",\n       x = x_label) +\n  theme(legend.position = \"top\") +\n  theme(strip.text = element_text(size = 12),\n        axis.text.y = element_text(size = 12), \n        axis.text.x = element_text(size = 10))\n\n\n\n\n\n\n\n\nFigure 2.8: Variation in (AGP) (g/L) (log-transformed) of women in Malawi by region and malaria test resutls. Grey line is the median AGP (log-transformed). Red line is the log-tranformed AGP cut-off value for infammation (1mg/L).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)</span>"
    ]
  },
  {
    "objectID": "data-dhs.html#socio-economic-data-dhsdata",
    "href": "data-dhs.html#socio-economic-data-dhsdata",
    "title": "2  Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)",
    "section": "2.2 Socio-economic data (DHSDATA)",
    "text": "2.2 Socio-economic data (DHSDATA)\nThere were some variables that may be related to differences in individual plasma Se variations that were recorded in the household questionnaire, for instance whelath quintile and wealth index.\n\n\nCode\n# Loading Wealth index and other variables (00_cleaning-dhs, line 346)\ndhs.df&lt;- haven::read_dta(here::here(\"data\",\"MWIR7AFL.dta\")) # survey data DHS\n\n\nWe extracted the socio-economic information from the DHS survey, however, we are only interested in the data for women and those with reported Plasma Se values.\n\n\nCode\n# Renaming and selecting variables of interest (reducing the number of variables)\n\ndhs.df &lt;- dhs.df %&gt;% dplyr::rename( \n  survey_cluster1='v001',\n  household_id1='v002',\n  LINENUMBER='v003', \n  survey_strata= \"v022\",\n  PSU = \"v021\", \n  region = 'v101', \n  urbanity = \"v102\", \n  # region = 'v024', \n  age_year = \"v012\", # for consistency \n  wealth_quintile= \"v190\",\n  wealth_idx= \"v190a\", # to check for wealth missing values\n  Literacy= \"v155\",\n  education_level= \"v106\", \n  source_water = \"v113\", # source of drinking water\n  # person_id=WomenID,\n  is_lactating= \"v404\", # breastfeeding yes=1, no=0\n  is_smoker= \"v463a\" # Only cover cigarettes (other smoking variables)\n) \n  \nDHSDATA &lt;- dhs.df %&gt;% dplyr::select(survey_cluster1, household_id1, LINENUMBER, survey_strata, PSU,\n             region, urbanity,  age_year, wealth_quintile, wealth_idx, Literacy,\n             education_level, source_water, is_lactating, is_smoker, sdist) %&gt;% \n  mutate_at(c(\"region\", \"urbanity\", \"wealth_quintile\", \"wealth_idx\", \"education_level\"  ,\"source_water\"), as.factor)\n\n# New variable with district names\nDHSDATA$dist_name &lt;- haven::as_factor(DHSDATA$sdist) \nDHSDATA$sdist  &lt;- as.factor(DHSDATA$sdist)\n\n\n\n2.2.1 Wealth Quintiles\n\n\nCode\n# Wealth quintile\nclass(DHSDATA$wealth_quintile)\nsum(is.na(DHSDATA$wealth_quintile))\ntable(DHSDATA$wealth_quintile)\nDHSDATA$wealth_quintile  &lt;- as.factor(DHSDATA$wealth_quintile)\n\n\nWealth index is calculated at household level, and it is based on the goods and housing characteristics. It was assessed using Principle Component Analysis and then made to each quintile to represent 20% of the population. In the report published by the NSO (2017), they reported significant differences between the number of individuals in each WQ when disaggregated by rural/urban residency.\nWhen plotted the WQ per region, we can see that the Central and Southern region have more or less even distribution of the WQ, however the Northern region has predominately highest and higher WQ, accounting for more than 60% of the population in the Northern region (unweighted results).\n\n\nCode\n# Wealth index (by urban/rural)\nclass(DHSDATA$wealth_idx)\nsum(is.na(DHSDATA$wealth_idx))\ntable(DHSDATA$wealth_idx)\nDHSDATA$wealth_idx  &lt;- as.factor(DHSDATA$wealth_idx)\n\n\nThen, there is another wealth variable (wealth_idx) that it is disaggregated by residency (rural/urban). This was developed recently in response of some criticism over the way the index is calculated, for more information see (REf=).\n\n\n2.2.2 Education\n\n\nCode\n# Education\nclass(DHSDATA$education_level)\nsum(is.na(DHSDATA$education_level))\ntable(DHSDATA$education_level)\nhaven::print_labels(DHSDATA$education_level)\nDHSDATA$education_level  &lt;- as.factor(DHSDATA$education_level)\n\n\nWe could see when wealth and education were plotted together, that most of the people with higher education was in the highest wealth quintile which is in line with the NSO report (NSO, 2017). Similarly, women in the lowest WQ has no high education.\nAll education and wealth level have representation in all three regions. Again, when looking at the data we could see that there is a slight “over-reporting” of the wealthiest quintiles.\nHence, we excluded this variable as it could possibly be confounding effect.\n\n\nCode\n# Wealth quintile 1-5 (lowest to highest)\n# Education 0-3 (low to high)\n\nplot(DHSDATA$wealth_quintile, DHSDATA$education_level, \n     main=\"Wealth vs Education\",\n     xlab=\"Wealth Q\", ylab=\"Education level\", pch=19)\n\n\nSimilarly, when we plotted the Education by region, we could see the same trend as in the WQ.\n\n\n2.2.3 Literacy\nThis variable was excluded as some of the results were misaligned. For instance, when comparing the literacy with the education level, all the women with secondary education reported literacy (n = NA), however, there were women who reported no literacy (0), but secondary education (2).\n\n\n2.2.4 Source of water\nThe source of water could have an influence on the plasma Se concentration, specially if the water is coming from local underground water or ponds, as the concentration of drinking Se water may be different according to their location, while drinking water coming from water bottled may have no minerals on it.\n\n\nCode\n# source of drinking water \nclass(DHSDATA$source_water)\ntable(DHSDATA$source_water)\nhaven::print_labels(DHSDATA$source_water)\n\n# New variable with descriptions\nDHSDATA$source_water_ds &lt;- haven::as_factor(DHSDATA$source_water)",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)</span>"
    ]
  },
  {
    "objectID": "data-dhs.html#combining-dhs-datasets-plasma-se-covariates",
    "href": "data-dhs.html#combining-dhs-datasets-plasma-se-covariates",
    "title": "2  Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)",
    "section": "2.3 Combining DHS datasets: Plasma Se & covariates",
    "text": "2.3 Combining DHS datasets: Plasma Se & covariates\n\n\nCode\n# Merging with DHS dataset to obtain Wealth index and other variables\n\nEligibleDHS &lt;- Malawi_WRA %&gt;% \n left_join(., DHSDATA %&gt;% \n          dplyr::select(survey_cluster1, household_id1, LINENUMBER, \n                 wealth_quintile, wealth_idx, Literacy, education_level, \n            source_water, is_lactating, is_smoker, sdist, \n            dist_name)) \n\n\nAccording to the study of Phiri et al (2019), the influencing factors for Plasma Se (for WRA) in Malawi were soil type and proximity to Lake Malawi.\nIn addition, other authors have reported that socio-economic characteristics may influence Se status.\nHere we are exploring the variability of Plasma Se according to those variables. First within the same dataset.\n\n2.3.1 Wealth & Plasma Se\nAfter merging the datasets, some WQ were missing, hence following recommendations form F.S we used the household WQ for those available to impute it. They were available for 17 of the 39 observation with missing values. For Plasma Se, we only have values for 770.\n\n2.3.1.1 Data inputation: Wealth quintile and index\nFirst, we checked whether the missing information on wealth was the same for the two variables (Q and index).\n\n\nCode\n#Checking rows with missing value for wealth Q\nn &lt;- which(is.na(EligibleDHS$wealth_quintile))\n#Checking rows with missing value for wealth Indx\nm &lt;- which(is.na(EligibleDHS$wealth_idx))\n# Checkin that are the same \ntable(n==m)\n\n\n\nTRUE \n  29 \n\n\nThen, we identifed for which cases we could inpute the informationf from the household level dataset.\n\n\nCode\n# Identifying HH ID & cluster of missing socio-eco info\nsubset(EligibleDHS, is.na(EligibleDHS$wealth_quintile), \n       select = c(\"household_id1\",\"survey_cluster1\")) %&gt;% left_join(.,DHSDATA) %&gt;% \n  group_by(survey_cluster1, household_id1) %&gt;% dplyr::count(wealth_quintile, wealth_idx, urbanity) %&gt;% \n  filter(!is.na(wealth_quintile)) %&gt;%\n  knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\n\n\nsurvey_cluster1\nhousehold_id1\nwealth_quintile\nwealth_idx\nurbanity\nn\n\n\n\n\n5\n4\n1\n1\n2\n1\n\n\n23\n68\n3\n4\n2\n1\n\n\n37\n70\n5\n4\n1\n2\n\n\n114\n4\n5\n2\n1\n2\n\n\n114\n283\n5\n3\n1\n1\n\n\n140\n51\n2\n3\n2\n1\n\n\n140\n111\n4\n4\n2\n2\n\n\n294\n64\n4\n5\n2\n1\n\n\n342\n15\n2\n2\n2\n1\n\n\n369\n180\n1\n1\n2\n2\n\n\n444\n107\n3\n3\n2\n1\n\n\n468\n147\n4\n5\n2\n1\n\n\n498\n229\n4\n4\n2\n3\n\n\n511\n257\n2\n2\n2\n1\n\n\n720\n267\n3\n3\n2\n1\n\n\n\n\n\nThen, we inputed the wealth Q and indx. from the cluster to the WRA dataset. By creating a dataframe with the information above, and looping over the missing values with information.\n\n\nCode\n#Sorting Wealth Q for each HH ID & cluster of missing info\nWealth &lt;- subset(EligibleDHS, is.na(EligibleDHS$wealth_quintile), \n       select = c(\"household_id1\",\"survey_cluster1\")) %&gt;% \n   left_join(., DHSDATA %&gt;% \n             dplyr::select(c(\"household_id1\",\"survey_cluster1\", \"wealth_quintile\", \"wealth_idx\"))) %&gt;% \n  group_by(survey_cluster1, household_id1) %&gt;%\n  filter(!is.na(wealth_quintile)) %&gt;% \n  distinct()\n\n\n# Generate a loop to assign Wealth Q from other member of the HH to non-reported people in biomarker survey data\nfor(i in seq_along(Wealth$household_id1)){\n  \nEligibleDHS$wealth_quintile[EligibleDHS$survey_cluster1 %in% Wealth$survey_cluster1[i] &\n                              EligibleDHS$household_id1 %in% Wealth$household_id1[i]] &lt;- Wealth$wealth_quintile[i]\n\nEligibleDHS$wealth_idx[EligibleDHS$survey_cluster1 %in% Wealth$survey_cluster1[i] &\n                              EligibleDHS$household_id1 %in% Wealth$household_id1[i]] &lt;- Wealth$wealth_idx[i]\n}\n\n\nThen, we compared plasma Se concentration by the two wealth variables. We can see that there are no much differences (Fig.). However, when disaggregating the data by rural and urban, we could see differences in the trends (See Fig). Since we are modeling based on this urban/rural differences, we chosen to use the wealth_idx variable in our model.\n\n\nCode\n# Wealth Quintile\nboxplot(selenium ~ wealth_quintile, data = EligibleDHS, \n     main=\"Plasma Selenium by Wealth Quintile\",\n     xlab=\"Wealth Quantile\", ylab=\"plasma Se (ng/ml)\", pch=19)\n\n\n\n\n\n\n\n\n\nCode\n# Wealth Idx\nboxplot(selenium ~ wealth_idx, data = EligibleDHS, \n        main=\"Plasma Selenium by Wealth Index\",\n        xlab=\"Wealth Quantile\", ylab=\"plasma Se (ng/ml)\", pch=19)\n\n\n\n\n\n\n\n\n\n\n\nCode\nboxplot(selenium ~ urbanity*wealth_quintile, data = EligibleDHS, \n        main=\"Plasma Selenium by Wealth Quintile & residency\",\n        xlab=\"Wealth Quantile\", ylab=\"plasma Se (ng/ml)\", pch=19, \n        col = c(\"white\", \"steelblue\"), frame = FALSE)\n\n\n\n\n\n\n\n\n\nCode\nboxplot(selenium ~ urbanity*wealth_idx, data = EligibleDHS, \n     main=\"Plasma Selenium by Wealth Index & residency\",\n     xlab=\"Wealth Quantile\", ylab=\"plasma Se (ng/ml)\", pch=19, \n     col = c(\"white\", \"steelblue\"), frame = FALSE)\n\n\n\n\n\n\n\n\n\nFinally, when we checked the overall distribution of the variable, seemed more sensible to use the combined (wealth_quintile) as the shape of the variable looked more equally distributed for our sample subset.\n\nWealth Quintile vs Wealth Index (urban/rural)\n\n\n\n1\n2\n1\n2\n\n\n\n\n1\n5\n141\n28\n121\n\n\n2\n1\n144\n33\n126\n\n\n3\n12\n145\n18\n115\n\n\n4\n20\n158\n21\n150\n\n\n5\n86\n79\n24\n155\n\n\n\n\n\n\n2.3.2 Education level\nPlasma Se values were slightly higher in the highest education level, with lower variability, while the opposite was true for the primary education level.\n\n\n2.3.3 Place of residency\nPlasma Se values were similar when aggregated by region, whereas we can start seeing some differences when we are plotting the results by district. Also notice, that the number of observations per district is 1) much smaller and 2) much diverse (from 0 to 51).\nThere are missing values 29 for the district variable which is an important variable (See Chapter 4), this was solved by using the district, of the same cluster (EA) as they should be in the same district.\n\n\nCode\n# Checking if we have same cluster with sdist for imputing.\ntest &lt;- unique(EligibleDHS$survey_cluster1[is.na(EligibleDHS$sdist)])\n\nEligibleDHS %&gt;% filter(survey_cluster1 %in% test) %&gt;% \n  distinct(survey_cluster1, sdist)\n\n\n# A tibble: 48 × 2\n   survey_cluster1 sdist\n             &lt;dbl&gt; &lt;fct&gt;\n 1             140 &lt;NA&gt; \n 2             114 &lt;NA&gt; \n 3             219 &lt;NA&gt; \n 4             369 &lt;NA&gt; \n 5              58 &lt;NA&gt; \n 6             294 &lt;NA&gt; \n 7             498 &lt;NA&gt; \n 8             468 &lt;NA&gt; \n 9             140 101  \n10              37 107  \n# ℹ 38 more rows\n\n\nCode\n# Fixing the missing values\nfor(i in 1:length(test)){\n  \nx &lt;- unique(na.omit(EligibleDHS$sdist[EligibleDHS$survey_cluster1 %in% test[i]]))\nEligibleDHS$sdist[EligibleDHS$survey_cluster1 %in% test[i]] &lt;- x\n\nx &lt;- unique(na.omit(EligibleDHS$dist_name[EligibleDHS$survey_cluster1 %in% test[i]]))\nEligibleDHS$dist_name[EligibleDHS$survey_cluster1 %in% test[i]] &lt;- x\n}\n\nsum(is.na(EligibleDHS$sdist))\n\n\n[1] 0\n\n\nBecause we are exploring how much Plasma Se variability is explained by Maize Se concentration, we do not need to apply (or worry about) the weights. Only, we would need to apply them if we want to express some findings at population level, e.g., perc. of population at risk. We are not likely to do that, as 1) it is not the objective of the study/ model, and 2) we are working at certain scales where data will not be representative (e.g., district).\nNote: What it would be important to check, it is whether the data is balance (e.g., highly skewed to one side and hence driving the model outcomes). We checked wealth by region and it seemed that there is a slight unbalance for the lowest Q in the middle region and towards the highest Q in the Northern region. See above (Section 2.2.1). Maybe we need to check for confounding effect.\n\n\nCode\n # Custom legend colour & labels\n col_break &lt;- c(\"1\" = \"#00BFC4\", \"2\" = \"#F8766D\")\n col_labels &lt;- c(\"1\" = \"Urban\", \"2\" = \"Rural\")\n unit_micro &lt;- expression(paste(\"Plasma Se conc. (ng  \",  mL^{-1}, \")\"))\n \nmicro_region(EligibleDHS, micro = selenium, var_sorting = sdist,\n             var_colouring = urbanity, unit_micro = unit_micro, label_sorting = \"Districts\", \n             col_break =col_break, col_labels = col_labels)\n\n\n\n\n\n\n\n\n\n\n\nCode\nEligibleDHS %&gt;% group_by(dist_name, region) %&gt;% \n  summarise(Median_se = median(selenium, na.rm = TRUE)) %&gt;% \n  arrange(desc(Median_se)) %&gt;% knitr::kable()\n\n\n\n\n\ndist_name\nregion\nMedian_se\n\n\n\n\nndanje\n3\n157.80285\n\n\nsalima\n2\n141.99920\n\n\nchikwawa\n3\n118.81947\n\n\nkasungu\n2\n100.68548\n\n\nmulange\n3\n97.02449\n\n\nnkhatabay\n1\n95.25494\n\n\nnkhota kota\n2\n92.60358\n\n\nlilongwe city\n2\n89.82441\n\n\nmzuzu city\n1\n84.78483\n\n\nphalombe\n3\n84.29541\n\n\nthyolo\n3\n83.34044\n\n\nmangochi\n3\n82.32660\n\n\nmwanza\n3\n81.29158\n\n\nrumphi\n1\n80.55195\n\n\nbalaka\n3\n80.52417\n\n\nblantyre city\n3\n80.19839\n\n\ndowa\n2\n78.73893\n\n\nkaronga\n1\n77.05011\n\n\nchradzulu\n3\n74.76317\n\n\nmchinji\n2\n73.02055\n\n\nmzimba\n1\n71.93091\n\n\nmachinga\n3\n70.48745\n\n\nblantyre rural\n3\n65.13585\n\n\nlilongwe rural\n2\n61.56710\n\n\nneno\n3\n61.09113\n\n\nzomba rural\n3\n59.53635\n\n\nntcheu\n2\n58.94337\n\n\nchitipa\n1\n51.72214\n\n\ndedza\n2\n49.37765\n\n\nntchisi\n2\n42.08151\n\n\n\n\n\n\n\n2.3.4 Smoking\nOnly 3 respondent reported smoking cigarettes, if we want to include this variable, we may need to combine with other smoking variables (including the other variables), although according with the systematic review published in 2015, the prevalence of women who smoke in this context was below 4% (Brathwaite et al. 2015), additionally a report published more recently by the Malawi Government using this survey found very low rates of smoking among women (Kadzamira, Gausi, and Phiri (2021)).\n\n\n2.3.5 Source of water & Plasma Se\nWe found 29 missing values in the variable source_water in the final dataset.\nWe then checked the mean Se concentration by the different sources\n\n\nCode\nddply(EligibleDHS, ~source_water, summarise, \n      median_PlasmaSe=matrixStats::weightedMedian(selenium, wt,na.rm = T))\n\n\n   source_water median_PlasmaSe\n1            11        78.62139\n2            12        80.86502\n3            13        75.82928\n4            14        77.97984\n5            21        74.88037\n6            31        81.46528\n7            32        81.97717\n8            41        84.16902\n9            42        71.19133\n10           43        70.53760\n11           62        58.64249\n12           96       116.03486\n13           97        97.88880\n14         &lt;NA&gt;        68.83009\n\n\nWe could see high plasma Se for those women reporting “other sources” of source of water, however there were only 4 women who were all living in the same cluster.\nNA, 641\nHence, we decided that because most of the women were getting their water from “tube well or borehole” (21) that if there was spatial variation due to the soil Se concentration, it should be captured with the maize Se concentration. In the future, we may want to expore this variable a bit more indepth and use other proxy variable to account for Plasma Se varaibitliy due to drinking water.\n\n\nCode\n# Survey analysis: Cleaned dataset weight \nEligibleDHS  &lt;- readRDS(file=here::here(\"data\", \"inter-output\",\"dhs_se_gps.rds\"))",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)</span>"
    ]
  },
  {
    "objectID": "data-dhs.html#sec-gps-location",
    "href": "data-dhs.html#sec-gps-location",
    "title": "2  Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)",
    "section": "2.4 GPS location",
    "text": "2.4 GPS location\n\n\nCode\n# Loading the dataset\n # GPS location DHS\nGPS &lt;- st_read(here::here(\"data\", \"MWGE7AFL\", \"MWGE7AFL.shp\"), quiet = TRUE)\n\n\n# Renaming variables\nGPS &lt;- dplyr::rename(GPS, survey_cluster1='DHSCLUST', Latitude='LATNUM', \n                    Longitude='LONGNUM',  altitude_in_metres='ALT_GPS')\n\n\nDue to confidentiality and anonymity protection, household locations are not available. Instead, the displaced GPS location of each cluster (i.e., EA) is provided. This means that the population centroid of each cluster was register in the original survey, and then displaced within 2km for urban clusters and 5km for rural clusters, with 10% of the rural clusters displaced within 10km buffer. Therefore, it is often not advised to used and/or link this type of data to distance-based measurement and/or small areas where high risk of missclassification may exist. This is because the location of the households could be in any of the EAs within the displaced buffer area.\nHence, we decided to use the buffer areas instead of the point locations (GPS coordinates) to standardise/ minimise the measurement error from the off-setting of the coordinates, and in turn, use the buffer area to identify the probable EAs where the households may be located. Here we added a buffer around each of the GPS locations that account for the 2km and 5km displacement in urban and rural respectively. In that sense, we are assuming that each HHs can be in any place with that buffered area.\n\n\nCode\n#  Generating the offset buffer\n\nfor(i in 1:nrow(GPS)){\n\n# Assigning buffer size (in m) acc. to Urban (U) or Rural (R)\noffset.dist&lt;-ifelse(GPS$URBAN_RURA[i]==\"U\", 2000, 5000)\n\n# Generating the buffers around the centroids\nGPS$buffer[i] &lt;- st_buffer(GPS$geometry[i], dist = offset.dist)\n\n}\n\n\nChecking the results of the displacement buffers\n\n\nCode\n# Transforming the list into spatial class\nGPS$buffer &lt;- st_as_sfc(GPS$buffer)\n\n# Checking that the output\nplot(GPS$buffer) # Plotting the buffer\nplot(GPS$buffer[GPS$URBAN_RURA == \"U\"],col='red',add=TRUE) # colouring red those that are urban (smaller radius)\n\n\n\n\n\n\n\n\n\nFinal cleaned dataset () and the spatial information (GPS) are merged andwas stored in: data/inter-output/dhs-gps.rds\n\n\nCode\n# Then the GPS w/ the geometry and buffer and the DHS data \nEligibleDHS &lt;- left_join(EligibleDHS, GPS) \n\n# Saving DHS + GPS dataset into R object \nsaveRDS(EligibleDHS, file=here::here(\"data\", \"inter-output\",\"dhs_se_gps.rds\"))\n\n\nThen, the next step will be to combine with the information on maize Se at different aggregation level.\nThis will be done using the script 00_cleaning-locations.R.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)</span>"
    ]
  },
  {
    "objectID": "data-dhs.html#limitations",
    "href": "data-dhs.html#limitations",
    "title": "2  Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)",
    "section": "2.5 Limitations",
    "text": "2.5 Limitations\n\n2.5.1 Limitations of DHS data\n\nTime influence: DHS survey was performed in 2015 while GeoNut was in 2018 and Chilimba in 2009. However, we could assume that the Se concentration would have been remain fairly similar over time (REF, REF).\nSeasonal variation: DHS survey was performed during Feb.- which are normally referred as the “hunger season” were food intake is at its lowest and food patterns and behaviours may be influenced by maize scarcity (at HH level). Including, other crop intakes and unrefined/ maize bran flour intake. However, according to previous studies, food patterns (related to maize intake) were fairly constant between IHS3-IHS5.\n\n\n\n2.5.2 Limitation to DHS-MNS data\n\nCluster level data: Most our analysis are based on location, however, we only have location information at cluster level. This would mean that when comparing with the maize values, those values will be the same for all the women within one cluster. We may need to account for it in our model design: for instance by adding the cluster as random effect. Additionally, we need to check the variation within cluster as this will affect our model selection and results.\nDisplacement of the GPS coordinates at cluster level. This led to high chances of missclassification and reducing the accuracy of the results for small area (e.g., EAs). It also led to the reduction of the no. of co-located (maize Se & plasma Se) samples.\nConfounding effect for certain variables: For instance, in the central and southern regions the women who were tested positive in malaria, where on average younger that those who were negative (see Section 2.1.3).\n\n\n\n\n\nBrathwaite, Rachel, Juliet Addo, Liam Smeeth, and Karen Lock. 2015. “A Systematic Review of Tobacco Smoking Prevalence and Description of Tobacco Control Strategies in Sub-Saharan African Countries; 2007 to 2014.” PLOS ONE 10 (7): e0132401. https://doi.org/10.1371/journal.pone.0132401.\n\n\nKadzamira, Mariam A. T. J., Harriet J. Gausi, and Tamara Phiri. 2021. “The Socio-Economic Impact of Disease Burden Due to Smoking in Malawi.”\n\n\n[Malawi], National Statistical Office (NSO), and ICF. 2017. “Malawi Demographic and Health Survey 2015-16.” https://dhsprogram.com/pubs/pdf/FR319/FR319.pdf.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Methods: Cleaning & Exploratory Analysis of the Malawi DHS (2015-2016)</span>"
    ]
  },
  {
    "objectID": "data-boundaries.html",
    "href": "data-boundaries.html",
    "title": "3  Boundaries of Malawi",
    "section": "",
    "text": "3.0.1 Administrative boundaries\nIn this study, we are trying to identify the optimal level of aggregation of maize grain Se composition data, hence different set of spatial aggregation units (areal units) were generated based on the administrative units of the country (Admin level 4 - EAs, Admin level 2 - districts), and based on household locations. For instance, areas based on the clusters reported in the DHS dataset. Therefore, spatial information regarding the boundaties (i.e., shapefiles) of Malawi are necesiary for our analysis.\nWe accessed and explored a number of boundaries from different sources to identify those that were of enough quality and useful for our analysis (i.e. data provenance is found in Section 1.3). Documenting the cleaning and decision made,and the final datasets used is the purpose of this section.\nIn order to identify where the data collected, both maize samples and clusters shapefiles (i.e., spatial datasets) with the boundaries (polygons) of each administrative units must be used. Particuarly for EAs, as that information is not provided by any of the datasets used.\nCode\n# Removing lakes from boundaries dataset\n# Selecting only variables that are interesting \n# fid, EA code, TA name, TA code, district, dist code, EA area & geometry)\nea_admin &lt;- ea_bnd %&gt;% filter(!grepl(\"lake\", DISTRICT,\n                                     ignore.case = TRUE)) %&gt;% \n  dplyr::select(c(1, 4, 9, 10, 11, 12, 17, 18))\n\n# Loop for adding the region Northern-Southern (1-3)\n\nea_admin$region &lt;- NA\n\nfor(i in 1:3){\n  ea_admin$region[grepl(paste0(\"^\", i), ea_admin$EACODE)] &lt;- i\n}\n\nea_admin %&gt;% filter(is.na(region))\n\n\nSimple feature collection with 0 features and 8 fields\nBounding box:  xmin: NA ymin: NA xmax: NA ymax: NA\nGeodetic CRS:  WGS 84\n[1] fid       EACODE    TA        TA_CODE   DISTRICT  DIST_CODE AREA_KM  \n[8] geometry  region   \n&lt;0 rows&gt; (or 0-length row.names)\nWe have found several shape files with the boundaries for Malawi (See Section 1.3). After exploring the boundaries datasets (pre-exploration using QGIS version (3.28.3) Firenze), we selected two data files: one for the EAs, the boundaries 3 ((ref-NSO?)) (ea_bnd) as the source of the polygons of each of the n= 9219 EAs. As this was the only file with information at that administrative level. This file contains some variables that were not necessary, and it also contained the shape of the lakes in Malawi. This were removed, and the trimmed dataset was used for further steps.\nCode\n## Combining EAs with \"authentic\" District\nea_admin &lt;-  st_join(ea_admin, dist_bnd)\nAdditionally, due to the sensitive nature of the EAs (i.e., used in census data and due to issues with breaching the confideciality of the data), the file is old (2013) hence the district are not up to date. For the districts to match the current official country boundaries and those reported in the DHS dataset, we are using those reported in boundaries dist_bnd, also generated by the NSO, and more recent (2023). This is particularly problematic as the district “Mwanza” was splited into two District “Mwanza” and “Neno”, which is not found in the file with the EAs.\nCode\ntm_shape(ea_admin %&gt;% filter(DISTRICT %in% \"Mwanza\")) +\n  tm_polygons(col = \"black\") +\n  tm_shape(dist_bnd %&gt;% filter(ADM2_EN %in% \"Mwanza\")) +\n  tm_polygons(\"ADM2_EN\", col_alpha = 0.1) +\n  tm_shape(ea_admin$geometry[ea_admin$EACODE %in% ea_admin$EACODE[is.na(ea_admin$ADM2_PCODE) & ea_admin$DISTRICT == \"Mwanza\"]]) +\n  tm_polygons( fill = \"red\") \n\n\n\n\n\n\n\n\nFigure 3.1: Location of the EAs ( 30601009 ) in Mwanza/Neno district.\nTo solve this, the two files were combined together however, some discrepancies arose. For instance, eight observations did not have a district. We visually checked the location of each “missing EA” within their districts, as it can be seen in the script (00_cleaning-boundaries.R). We added that information to each EA of their corresponding districts following in the “old” (ea_bnd) file but for the EAs in Mwanza as they lied in Neno, as it can be seen in the Figure 3.1.\nThe EA that was manually recoded to the current corresponding distrinct.\nCode\nea_admin$ADM2_EN[is.na(ea_admin$ADM2_PCODE) & ea_admin$DISTRICT == \"Mwanza\"] &lt;- \"Neno\"\nThen, this file with the EAs and the correct district was save as a shapefile, and it will be used in further steps.\nCode\n# Saving the new dataset with \"correct\" district for each EA ----\n\nst_write(ea_admin, here::here( \"data\", \"inter-output\", \n           \"boundaries\", \"mwi_admbnda_adm4_nso.shp\"))",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Boundaries of Malawi</span>"
    ]
  },
  {
    "objectID": "data-boundaries.html#sec-boundaries",
    "href": "data-boundaries.html#sec-boundaries",
    "title": "3  Boundaries of Malawi",
    "section": "3.1 Generating boundaries for maize aggregation levels",
    "text": "3.1 Generating boundaries for maize aggregation levels\nIn order to calculate the mean/median value for each level of aggregation first, we need to generate the boundaries that will be used.\nThe first two aggregations (areal units) were based on administrative boundaries (i.e., EAs, districts) whereas the other two aggregation levels were based on the food catchment area or food-sheds (buffer area). All of the aggregation units took into consideration the cluster displacement nature of the location.\n\n\n\n\n\n\nNote\n\n\n\nThe location (GPS coordinates) provided in the DHS are for each cluster, not per individual or household (i.e., one women or more will share the exact same GPS coordinates).\n\n\n\n3.1.1 Administrative boundaries areas\nWe started with the EAs because are the smallest administrative units, and they are nested within the other (bigger) administrative units (Districts and Regions).\nDue to the nature of the displaced cluster location, the smallest administrative unit will not be one EA per women, but a number of EAs per cluster for all the women living in the same cluster. For more information on the GPS displacement see Section 2.4 and the Guidelines on the Use of DHS GPS Data from Perez-Heydrich et al. (2013).\nThe EAs included in each cluster are based on the displacement range (2.5km for urban and 5km per rural) bounded by district, full details are disclosed below. While for the district information it was provided within the DHS dataset.\n\n3.1.1.1 Enumeration Areas\nIn the DHS plasma dataset, we do not have information about the EAs where each women or cluster point lies in. Therefore, in order to calculate the mean/media maize Se concentration for each administrative unit, we need to identify the EAs that were plausible residing place for the women in the DHS survey, as mentioned above. The buffer areas were added in previous step (See Section 2.4).\nTo do so, we need to spatially merge the boundaries dataset (ea_admin) and the plasma Se dataset. Hence, some data preparation need to be done before carrying the spatial join. For instance, both datasets need to be spatial objects.\n\n\nCode\n# Checking the class of the two datasets\nclass(ea_admin)\n\n\n[1] \"sf\"         \"data.frame\"\n\n\nCode\nclass(plasma.df)\n\n\n[1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n\n\nWe can see that the plasma.df is not a spatial object. Therefore, we need to use the sf package to convert it into a spatial dataset. Here, we are interested in the buffer areas and that is the variable that was converted into the geometry variable.\n\n\nCode\n# Getting only cluster location (to avoid duplicates)\n\ngeodata.df &lt;- plasma.df %&gt;% dplyr::select(survey_cluster1, buffer) %&gt;% \n  distinct() %&gt;% \n# renaming buffer as geometry for converting into spatial object\n  dplyr::rename(geometry = \"buffer\") %&gt;% st_sf(., crs = \"EPSG:4326\")\n\n# Checking the effect of the line above\nclass(geodata.df)\n\n\n[1] \"sf\"         \"tbl_df\"     \"tbl\"        \"data.frame\"\n\n\nThen, after converting and checking that the plasma.df is a spatial object, we can proceed with the spatial join to identify the Malawi EAs (ea_admin) within the buffered areas for each cluster.\n\n\nCode\n# Getting info on the admin boundaries (EA/district level)\n# Allocating buffered areas to each admin unit\n\ngeodata_ea &lt;-  st_join(geodata.df, ea_admin)\ngeodata_ea$region &lt;- as.factor(geodata_ea$region)\n\n\nIn the Figure 3.2, we can see, in dark red, the EAs that were within the buffered areas, and in blue the buffers.\n\n\nCode\n# Aggregate boundaries the whole country (with lakes)\nmalawi_bnd_lakes &lt;- st_union(ea_bnd)\n\n# Aggregate boundaries the whole country\nmalawi_bnd &lt;- st_union(ea_admin)\n\n# tmap_mode(\"view\")\n\n# Generating the map\ntm_shape(ea_admin) +\n  tm_polygons(fill = \"white\", \n              col = \"#666666\", col_alpha = 0.3, lwd = 0.2) +\ntm_shape(malawi_bnd) +\n  tm_borders(col = \"#666666\", fill_alpha = 0.6, lwd = 0.5) +\n  tm_shape(malawi_bnd_lakes) +\n  tm_borders(col = \"black\", fill_alpha = 0.6, lwd = 0.5) +\n    tm_shape(ea_admin$geometry[ea_admin$EACODE %in% unique(geodata_ea$EACODE)]) +\n  tm_polygons(fill =\"firebrick4\", col = \"black\", col_alpha = 0.3) +\n tm_shape(geodata.df) +\n  tm_borders(col = \"steelblue\")# +\n#tm_view(set.view = c(-13.2284,8.4699, 13), set.zoom.limits = c(13,14))\n\n# tmap_mode(\"plot\")\n\n\n\n\n\n\n\n\nFigure 3.2: Map of Malawi with the possible EAs where the household that were surveyed in the DHS-MNS may reside (in dark red), and the buffer representing the GPS displacement (in blue).\n\n\n\n\n\nWhen we checked the EAs that were included in each cluster, we realised that there were some clusters that were very close to the district boundaries, thus including some EAs from different district. According to the DHS documentation, displacement was performed to respect district boundaries, hence households will be within their district (see district information on DHS dataset) and because here we are looking at administrative boundaries, we need to remove the EAs that did not belong to the district for each cluster.\n\n\nCode\n# Checking the EAs per buffer and district\n\n(g1 &lt;- geodata_ea %&gt;%  st_drop_geometry() %&gt;% \n  mutate_at(\"survey_cluster1\", as.character) %&gt;% \n  ggplot(aes(x=reorder(survey_cluster1, survey_cluster1, function(x)-length(x)))) +\n  geom_bar(aes(fill = DISTRICT)) +\n  theme_bw() +\n  labs(\n    x = \"Cluster\") + \n  scale_x_discrete(guide = guide_axis(n.dodge = 2)) +\n  theme(strip.text = element_text(size = 12),\n        axis.text.y = element_text(size = 12), \n        axis.text.x = element_text(size = 10, angle =30)))\n\n\n\n\n\n\n\n\nFigure 3.3: The bars show the number of EAs in each DHS cluster and the colours represent the districts.\n\n\n\n\n\nMoreover, we can see in Figure 3.4 that some buffer-cluster areas extended beyond the district including district from different regions.\n\n\nCode\ng1 + \n  facet_wrap(~region, labeller = as_labeller(c(`1` = \"Northern\", \n                                               `2` = \"Central\", \n                                               `3` = \"Southern\")),\n             scales = \"free_x\") +\n  theme(legend.position=\"top\") \n\n\n\n\n\n\n\n\nFigure 3.4: The bars show the number of EAs in each DHS cluster divided by regions and the colours represent the districts.\n\n\n\n\n\nWe identified the correct district for each EA by combining the district names (dist_name) in the DHS survey and the district names (ADM2_EN) in the ea_admin dataset. For more information on that dataset and variables see Chapter 3.\nSome minor spelling adjustment was needed in order to identify the correct district and a dummy variable to check district name consistency was generated, as shown in the following code block.\n\n\nCode\n# Checking the districts in plasma dataset\n# Converting back from spatial obj to dataframe\nplasma.df  &lt;- geodata_ea  %&gt;% st_drop_geometry()  %&gt;%  # removing geometry\n  right_join(., plasma.df, relationship = \"many-to-many\")  # multiple EAs per cluster,                                                         multiple WRA per cluster. \n\n\n# New variable to check the correct district (based on survey)\nplasma.df$dist_name2 &lt;- as.character(plasma.df$dist_name)\n\n# Changing the spelling to fit the NSO boundaries file \nplasma.df$dist_name2 &lt;- gsub(\"nkhota kota\", \"nkhotakota\", plasma.df$dist_name2)\nplasma.df$dist_name2 &lt;- gsub(\"lilongwe rural\", \"lilongwe\", plasma.df$dist_name2)\nplasma.df$dist_name2 &lt;- gsub(\"ndanje\", \"nsanje\", plasma.df$dist_name2)\nplasma.df$dist_name2 &lt;- gsub(\"zomba rural\", \"zomba\", plasma.df$dist_name2)\nplasma.df$dist_name2 &lt;- gsub(\"blantyre rural\", \"blantyre\", plasma.df$dist_name2)\nplasma.df$dist_name2 &lt;- gsub(\"mulange\", \"mulanje\", plasma.df$dist_name2)\nplasma.df$dist_name2 &lt;- gsub(\"chradzulu\", \"chiradzulu\", plasma.df$dist_name2)\n\n# Dummy variable to check whether districts are the same or not\nplasma.df$boundaries_check &lt;- ifelse(tolower(plasma.df$ADM2_EN) == plasma.df$dist_name2, TRUE, FALSE)\n\n# Checking district that are the same and those with NA (some dist_name were NA)\nplasma.df %&gt;%  dplyr::filter(boundaries_check == TRUE | is.na(boundaries_check) ) %&gt;% \n  select(survey_cluster1, ADM2_EN, dist_name2, boundaries_check) %&gt;% distinct() %&gt;% \n  # Changing the class of the cluster for table improvement\n  mutate_at(\"survey_cluster1\", as.character) %&gt;% \n# Make the interactive table\ndatatable(., filter = \"top\")\n\n\n\n\n\n\nAfter checking that all the survey cluster has the correct district, and indentifying the “wrong” districts, those that were “self-included” due to the EAs that were falling within the displacement buffer.\n\n\nCode\n# Showing the table with the EACODEs and the \"wrong\" districts\nplasma.df %&gt;% dplyr::filter(boundaries_check == FALSE) %&gt;% \n  select(survey_cluster1, EACODE, ADM2_EN, dist_name2, boundaries_check) %&gt;% \n  distinct()  %&gt;% \n# Changing the class of the cluster for table improvement\n  mutate_at(\"survey_cluster1\", as.character) %&gt;% \n# Make the interactive table\ndatatable(., filter = \"top\")\n\n\n\n\n\n\nWe filtered only the correct district for each cluster, and saved as a dataset containing each cluster (survey_cluster1) and their corresponding district (ADM2_EN).\nThat dataset (district) was used to exclude those EAs that were not in the corresponding district for each cluster. Note that Likoma is the only district that is missing from the plasma Se dataset (plasma.df), this was not sampled (or sampled but included in Salima as the number of samples were too small).\n\n\nCode\n# Getting the cluster and corresponding district\ndistrict &lt;- plasma.df %&gt;% dplyr::filter(boundaries_check == TRUE) %&gt;%\n  distinct(survey_cluster1, ADM2_EN)\n\n# Then we check that we have all the cluster covered\nlength(unique(plasma.df$survey_cluster1))- length(unique(district$survey_cluster1))\n\n\n[1] 0\n\n\nCode\n# knitr::kable(district)\n\n# Checking Likoma in plasma dataset\nplasma.df %&gt;% dplyr::filter(dist_name2 == \"likoma\") %&gt;% \n  select(survey_cluster1, ADM2_EN, dist_name2) %&gt;% distinct()\n\n\n# A tibble: 0 × 3\n# ℹ 3 variables: survey_cluster1 &lt;dbl&gt;, ADM2_EN &lt;chr&gt;, dist_name2 &lt;chr&gt;\n\n\nAnother district that has a minor difference is “Zomba”, as for sampling is often divided between rural (“Zomba”) and urban (“Zomba City”). We checked and the entries corresponding to Zomba and were all rural.\n\n\nCode\n# Checking Zomba in plasma dataset\nplasma.df %&gt;% dplyr::filter(dist_name2 == \"zomba\") %&gt;% \n  select(survey_cluster1, urbanity) %&gt;% distinct()\n\n\n# A tibble: 3 × 2\n  survey_cluster1 urbanity\n            &lt;dbl&gt; &lt;fct&gt;   \n1             218 2       \n2              64 2       \n3             842 2       \n\n\nCode\n# Checking Zomba City in plasma dataset\nplasma.df %&gt;% dplyr::filter(ADM2_EN == \"Zomba City\") %&gt;% \n  select(survey_cluster1, EACODE, ADM2_EN, dist_name2, urbanity) %&gt;% distinct()\n\n\n# A tibble: 7 × 5\n  survey_cluster1   EACODE ADM2_EN    dist_name2 urbanity\n            &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;fct&gt;   \n1             218 30307901 Zomba City zomba      2       \n2             218 30335001 Zomba City zomba      2       \n3             218 30307033 Zomba City zomba      2       \n4             218 30301044 Zomba City zomba      2       \n5             218 30335002 Zomba City zomba      2       \n6             218 30335004 Zomba City zomba      2       \n7             218 30335003 Zomba City zomba      2       \n\n\nCode\n# Checking Zomba City in plasma dataset\nplasma.df %&gt;% dplyr::filter(dist_name2 == \"zomba\") %&gt;% \n  select(survey_cluster1, EACODE, ADM2_EN, dist_name2, urbanity) %&gt;% distinct()\n\n\n# A tibble: 128 × 5\n   survey_cluster1   EACODE ADM2_EN dist_name2 urbanity\n             &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;fct&gt;   \n 1             218 30307024 Zomba   zomba      2       \n 2             218 30301017 Zomba   zomba      2       \n 3             218 30301031 Zomba   zomba      2       \n 4             218 30301019 Zomba   zomba      2       \n 5             218 30307809 Zomba   zomba      2       \n 6             218 30301045 Zomba   zomba      2       \n 7             218 30307023 Zomba   zomba      2       \n 8             218 30307807 Zomba   zomba      2       \n 9             218 30307019 Zomba   zomba      2       \n10             218 30307021 Zomba   zomba      2       \n# ℹ 118 more rows\n\n\nCode\n# Generating the map\ntm_shape(dist_bnd) +\n  tm_polygons(fill = \"white\", \n              col = \"#666666\", col_alpha = 0.3, lwd = 0.2) +\ntm_shape(malawi_bnd) +\n  tm_borders(col = \"#666666\", fill_alpha = 0.6, lwd = 0.5) +\n  tm_shape(malawi_bnd_lakes) +\n  tm_borders(col = \"black\", fil_alpha = 0.6, lwd = 0.5) +\n    tm_shape(ea_admin %&gt;% filter(grepl(\"Zomba\",ADM2_EN))) +\n  tm_polygons(fill =\"ADM2_EN\", col = \"black\", col_alpha = 0.3) \n\n\n\n\n\n\n\n\n\nFinally, we exlcuded those that were on the “wrong” districts, including those that were in “Zomba City”, as the were all rural.\n\n\nCode\n# Excluding EAs that were not with the corresponding district for each cluster\nplasma.df &lt;- left_join(district, plasma.df)\n\n# Checking Zomba City in plasma dataset\nplasma.df %&gt;% dplyr::filter(ADM2_EN == \"Zomba City\") %&gt;% \n  select(survey_cluster1, EACODE, ADM2_EN, dist_name2, urbanity) %&gt;% distinct()\n\n\n# A tibble: 0 × 5\n# ℹ 5 variables: survey_cluster1 &lt;dbl&gt;, EACODE &lt;dbl&gt;, ADM2_EN &lt;chr&gt;,\n#   dist_name2 &lt;chr&gt;, urbanity &lt;fct&gt;\n\n\nFinally, we generated the administrative boundaries master file which contains information on each cluster (survey_cluster1) and its cluster-EA level (all the EAs within the corresponding buffer areas and district) and the district. The codes (EACODE and ADM2_PCODE) can be bind with the respective shapefiles (ea_bnd, ea_admin or dist_bnd).\n\n\nCode\n# Saving the master file with the survey cluster (id) and the admin level\n# EAs, districts, and regions.\n\nplasma.df %&gt;% distinct(survey_cluster1, EACODE, urbanity, \n                        ADM2_PCODE, ADM2_EN, ADM1_PCODE, ADM1_EN) %&gt;% \n   filter(!is.na(ADM1_EN))  %&gt;% # Only one NA as per above\n   saveRDS(here::here(\"data\", \"inter-output\", \"aggregation\", \"master-cluster-admin-level.RDS\"))\n\n\n\n\n3.1.1.2 Districts in Malawi\nHere we are showing a map of the districts of Malawi.\n\n\nCode\n# Aggregate boundaries the whole country (with lakes)\nmalawi_bnd_lakes &lt;- st_union(ea_bnd)\n\n# Aggregate boundaries the whole country\nmalawi_bnd &lt;- st_union(ea_admin)\n\n# Generating the map\ntm_shape(dist_bnd) +\n  tm_polygons(fill = \"white\", \n              col = \"#666666\", col_alpha = 0.3, lwd = 0.2) +\ntm_shape(malawi_bnd) +\n  tm_borders(col = \"#666666\", fill_alpha = 0.6, lwd = 0.5) +\n  tm_shape(malawi_bnd_lakes) +\n  tm_borders(col = \"black\", fil_alpha = 0.6, lwd = 0.5) +\n    tm_shape(ea_admin$geometry[ea_admin$EACODE %in% unique(geodata_ea$EACODE)]) +\n  tm_polygons(fill =\"firebrick4\", col = \"black\", col_alpha = 0.3) \n\n\n\n\n\n\n\n\n\n\n\n\n3.1.2 Household catchment areas (buffer)\nFor the household catchment areas, ideally, we would like to test the aggregation of the maize grain Se as function of the distance from each household. For instance, with buffered areas around the household, that could be identified as “food-sheds” or “food catchment areas”. However, as explained in previous sections, the location used to generate the buffer are not the real household location but an approximation. By generating bigger than the displacement area buffers we aim to capture the plausible “food catchment area” for each WRA in the sample while accounting for the error/bias due to the displacement.\n\n\nCode\n# Getting the cluster and their centroid to generate the two buffered areas.\nGPS &lt;- plasma.df %&gt;% distinct(survey_cluster1, Longitude, Latitude)\n\n# Transforming maize data.frame into a spatial object (geometry) \ngeogps &lt;- st_as_sf(GPS , coords =c(\"Longitude\", \"Latitude\"),\n                   crs = \"EPSG:4326\")\n\n\nThe catchment areas represented by buffers around the cluster displaced centroids and three distances selected were:\n\n15km buffer to cover the maximum displacement in rural area for the GPS location of the DHS clusters. The maximum displacement in rural area is 10km however, when we tested the 10km buffer, we found that one EA (497) did not have an observed sample within that range, thus we decided to increase the buffer size by 5km, we also tested 12km but it did not provide any improvement from the 10km buffer.\n25 and 30km buffer that cover a sensible distance between EAs and district, and which is according to REF, the average distance between households and the closest market in Malawi (REF).\n\nThe genereation of the buffer is done using a loop, that save the shapefiles into the inter-outuput file, and it is design to be able to change the distances of the buffer if new evidence of bigger or smaller buffer are published. It also allowed us to do sensitivity analysis on buffer size, see Section 6.4.1.1.\n\n\nCode\n# Choice of buffers (in km)\nbuffer &lt;- c(10, 25, 30)\n\n# Loop over the number of buffers:\nfor(i in 1:length(buffer)){\n  \n  data.df &lt;- GPS\n  # Transforming km in m (e.g., 10km = 1000m)\n  distance &lt;- buffer[i]*10^3\n  \n  # Buffer in meters \n  data.df$buffer &lt;- st_buffer(geogps$geometry, dist = distance)\n  \n  # Saving the shapefile with the buffers\n  st_write(data.df, here::here( \"data\", \"inter-output\", \n                                \"boundaries\", \n                                paste0(\"mwi_gps-buffer\", buffer[i], \".shp\")))\n  \n}\n\n\nThis loop was converted into a function to generate the buffers for reproducibility. So the final set of boundaries were generated using the function buffer_generator() (See function folder).\n\n\n\n\nPerez-Heydrich, Carolina, Joshua L Warren, Clara R Burgert, and Michael Emch. 2013. Guidelines on the Use of DHS GPS Data. ICF International. https://dhsprogram.com/pubs/pdf/SAR8/SAR8.pdf.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Boundaries of Malawi</span>"
    ]
  },
  {
    "objectID": "data-maize.html",
    "href": "data-maize.html",
    "title": "4  Cleaning maize grain Se concentration in Malawi",
    "section": "",
    "text": "4.1 GeoNutrition (Kumssa et al., 2022)\nCode\n# Loading packages\nlibrary(plyr) # weighted data analysis\nlibrary(dplyr) # data wrangling \nlibrary(sf) # spatial data manipulation\nlibrary(ggplot2) # data visualisation\nlibrary(spdep) # grid and neighbours\nlibrary(tmap) # (spatial) visualisation\nsource(here::here(\"functions\",\"CEPHaStat_3.R\"))\n\n\nCEPHaStat version  3\n\nCEPHaStat is a collection of R functions produced by the UKRI GCRF\nCEPHaS project.  The functions relate primarily to statistical analysis of\nsoil and related data from agricultural and environmental surveys and \nexperiments.  The CEPHaStat file can be shared as it stands, and is made \navailable to all for use, without warranty or liability.\n\n\nCode\n# Loading maize data (Kumssa - GeoNut, 00_cleaning-maize, line 16)\n# Grain & soil chem data\ndata.df  &lt;- read.csv(here::here(\"data\", \"maize\", \"MWI_CropSoilChemData_CSV\", \n \"MWI_CropSoilData_Raw.csv\"))\nWe extracted multiple variables of interest (including the LOD), which served to:\nDue to the high number of BLOD we have generated four Se variables to test sensitivity of the model.\nCode\nsubset(data.df, ID %in% c(\"MWI0574\", \"MWI1007\",\"MWI1138\",\"MWI1168\",\"MWI1171\",\"MWI1686\"), \n       select = c(ID, Crop, Se_grain)) %&gt;% knitr::kable()\n\n\n\n\n\n\nID\nCrop\nSe_grain\n\n\n\n\n563\nMWI0574\nMaize\nNM\n\n\n993\nMWI1007\nMaize\nNM\n\n\n1124\nMWI1138\nMaize\nNM\n\n\n1154\nMWI1168\nMaize\nNM\n\n\n1157\nMWI1171\nRice\nNM\n\n\n1672\nMWI1686\nMaize\nNM\nAdditionally, the MAT values were added to this dataset for each sample location (i.e., GPS coord.), as this study only reported analytical values carried as part of the GeoNutrition project. These values were completed when extracting the MAT for the Chilimba et al. (2011) sample locations.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Cleaning maize grain Se concentration in Malawi</span>"
    ]
  },
  {
    "objectID": "data-maize.html#geonutrition-kumssa-et-al.-2022",
    "href": "data-maize.html#geonutrition-kumssa-et-al.-2022",
    "title": "4  Cleaning maize grain Se concentration in Malawi",
    "section": "",
    "text": "check the NA values (n=427) for maize Se concentration in found in the dataset published in Gashu et al. study (2021).\nto add those values as possible solution for accounting for the high number of missing maize Se conc. values.\n\n\n\nSe_raw: This variable contains the values as reported from the chemical analysis including the values BLOD. Cleaning steps:\n\n\nNo measured: Six Se values were coded as not measured (“NM”) , which were transformed into NA.\n\n\n\nNegative (or zero) values: 21 values were negative and converted to the smallest limit of detention value (0.002..). We tested to convert it into: zero, which is a problem for a number of reasons, including that zero cannot be log transformed (-Inf.), and to the minimum value in the dataset (0.0009) which again generate problems with outliers, and skewerness.\n\n\nSe_std: This variable contains Se values as above, however BLOD values were substituted with their respective LOD value (as per each round of test, see Crop_ICP_Run_Se & Se_LOD variable).\nSe_grain: This contains the Se values reported above the LOD, where values BLOD were excluded (i.e., converted into NA), as was previously done by Gashu et al., 2021 and reported in the “MWI_CropSoilData_NA.csv” dataset in Kumssa et al, 2022.\n\n\n\n4.1.1 Spatial preliminary analysis\nThe missing (i.e., BLOD values) are spatially clustered, which probably will influence (unbalancing) our results (Kumssa et al, 2022). We hypothesised that this is due to high concentration of very low maize grain Se concentration values likely driven by soil and environmental factors in those affected regions ((ref?)).\nAlthough, the samples collected provided a good coverage of Malawi, there were 2200 EAs without a maize Se conc. samples. In addition, low number of maize samples were found in the southern region of Malawi (Shire Valley), leading to a more scarce and, probably higher uncertainty in that region. Moreorver, consumption of maize in that region is comparable with the other regions of Malawi, and probably the main reason for the lower maize values is that the harvest season is slightly earlier than in other regions of Malawi (probably due to difference in the climatic patterns), and hence maize was not found when the field team were there to collect the data.\nIn order to minimise the impact on our model, and after checking that maize consumption is the same as other regions in Malawi (even slightly higher), we decided to explore other datasets which led to the inclusion of maize samples from Chilimba et al. study (2011) (see data section & next section).",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Cleaning maize grain Se concentration in Malawi</span>"
    ]
  },
  {
    "objectID": "data-maize.html#mineral-concentration-in-maize-chilimba-et-al.-2011",
    "href": "data-maize.html#mineral-concentration-in-maize-chilimba-et-al.-2011",
    "title": "4  Cleaning maize grain Se concentration in Malawi",
    "section": "4.2 Mineral concentration in maize (Chilimba et al., 2011)",
    "text": "4.2 Mineral concentration in maize (Chilimba et al., 2011)\n\n\nCode\n# Loading maize data (complementary) (Chilimba, 00_cleaning-maize, line 16)\nmaize  &lt;- readxl::read_excel(here::here(\"data\", \"maize\",\n \"AllanChilimbaFieldData_forLucia_20230615.xlsx\"), sheet = 1)\n\n\nThis dataset provided Se concentration in maize grain and pH in soil (measured in water) in the same locations, however it did not contain information on the MAT (BIO1) for each location, which are used for the maize aggregation model (see _02modelling).\nWe extracted the variable of interest, removed NA and checked the coordinate projections to make sure both datasets (GeoNutrition & this dataset) were compatible (both datasets provided longitude and latitude data in decimal degrees, WGS84 datum, coordinate reference system EPSG:4326).\n\n\nCode\n#Renaming variable & adding info on data source\nnames(maize)[c(23, 28)]  &lt;- c( \"Se_mg\", \"pH_w\")\nmaize$survey  &lt;- \"Chilimba\"\n\n# Getting variables of interest 1:12 (sample descript), grain_se and pH\nmaize  &lt;-  maize[,c(1:11, 23, 28, 56)]\n\n# Checking values \nsum(is.na(maize$Se_mg)) # Only 2\n\n\n[1] 2\n\n\nWhen we checked the distribution of the sample (Figure 4.1, Figure 4.2), we can see that the log-distribution shape is a bit odd. This may be related to the majority of the samples were collected from high maize Se conc. areas (i.e., Shirey valley), which, paired with probably the omission of BLOD values, led to a large number of high concentration values.\n\n\nCode\nsummaplot(maize$Se_mg)\n\n\n[1] 2  missing value(s) removed\n\n\n\n\n\n\n\n\nFigure 4.1: Distrubution of maize Se concentration from the study of Chilimba et al. (2011).\n\n\n\n\n\n\n\nCode\nsummaplot(log(maize$Se_mg))\n\n\n[1] 2  missing value(s) removed\n\n\n\n\n\n\n\n\nFigure 4.2: Distrubution of log transformed maize Se concentration from the study of Chilimba et al. (2011).",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Cleaning maize grain Se concentration in Malawi</span>"
    ]
  },
  {
    "objectID": "data-maize.html#sec-exclusion",
    "href": "data-maize.html#sec-exclusion",
    "title": "4  Cleaning maize grain Se concentration in Malawi",
    "section": "4.3 Excluded datasets",
    "text": "4.3 Excluded datasets\nHere, we provide information about the data exploration and main reasons for exclusion of the datasets.\n\n4.3.1 GeoNutrition (Gashu et al., 2021)\nThis dataset was excluded because high percentage of values were transformed to NA some of which were BLOD values for maize Se concentration. However the cleaning scripts are provided in this repository.\nWe extracted the variables of interest from the dataset: Se conc. (only in maize), pH, MAT, and the coordinates. Then we are doing some data operations, for instance, removing NAs (values &gt;999) in Se conc. and checking missing values for the covariates.\nTwo pH values were missing, hence we may exclude those values for the modelling, also there were three locations with missing MAT. This could be have been completed when extracting the MAT for the Chilimba et al. (2011) sample locations.\n\n\n4.3.2 Mineral concentration in crops (Joy et al., 2014)\nThis study was excluded because it did not provided substantial information (i.e, only few new samples), while it would potentially add more uncertainity to the final results. The script for cleaning the dataset is provided in this repository.\nThis study collected data for various crops, hence we needed to clean the dataset to obtain only the information for maize Grain. We also excluded maize flour to keep it consistent with our dataset. In addition, soil pH values were extracted to be used as model covariates.\nOne limitation of the dataset is that the GPS location were only provided for crops and not for soils, hence we were trying to use some information (STable10) to combine the sample number with the soil samples. These led to the correct allocation of a pH value for 57 of the 155 samples.\nAccording to the documentation, soil samples were not taken when the samples were collected at the market. We are then assuming that samples without pH value were collected at the market and hence should be excluded from our analysis. Then, only one or two samples were collected in the Shire Valley, thus this sample dataset will not be contributing substantially to reduce the uncertainty, and it may add other sources of variability (i.e., temporal, analytical, etc). Hence, it was excluded from the final dataset.\n\n\n4.3.3 Mean Annual Temperature\nMean Annual Temperature (MAT) was used as environmental covariate for the aggregation of maize Se model. The data was extracted from the CHELSA dataset which was downloaded from here on 2023/07/17 and cropped for Malawi for easy usage. The geographic coordinate system are referenced to the WGS 84 horizontal datum, with the horizontal coordinates expressed in decimal degrees.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Cleaning maize grain Se concentration in Malawi</span>"
    ]
  },
  {
    "objectID": "data-maize.html#the-combined-dataset-crop-se-dataset",
    "href": "data-maize.html#the-combined-dataset-crop-se-dataset",
    "title": "4  Cleaning maize grain Se concentration in Malawi",
    "section": "4.4 The combined dataset: Crop Se dataset",
    "text": "4.4 The combined dataset: Crop Se dataset\nWhen we combined both GeoNutrition (Kumassa et al, 2022) and Chilimba datasets, as expected, the maize Se concentration is heavily skewed and it would need log transformation, while pH has a normal distribution.\nFor more information on that see the exploratory analysis and the variable selection for the model reported in Gashu et al., (2019) (ref?) and the analysis done by Lark et al. (2019), here are the scripts.\n\n4.4.1 Limitations of the maize data\n\nHigh proportion of below limit of detection values: The number of below detection limit values of selenium (Se) in Malawi were high (~25%) due to the very low Se concentration in maize found in the country which in turn would highly affect our final results. Therefore, some considerations were taken and were explained in the data exploration (Chapter 2) as well as in the modelling section (Section 3.x). See also notes in Kumssa et al. (2022). Potential risk of bias:\n\nHigh uncertainty of the results leading to potential over-estimation (or under-) of maize Se concentration.\nIf data were excluded, a) the values would not be missing at-random as they have a spatial pattern (i.e, particular areas of the country were affected mostly), b) left-censoring data set which mean/median overestimation of maize concentration.\n\nLow maize data availability in Southern Malawi region: We found mostly other crops (e.g., millet, sorghum, etc.) (~11%) were collected in Southern Malawi instead of maize. It could be because the harvest season is slightly earlier in that area and hence the fields were already harvested and other crops planted when the data collection happened ((ref?)). This led to the inclusion of another datas set to increase the maize samples in that region, which it has its own limitation (see next point).\nDifferent sampling time For the Chilimba study, the samples were collected during 2009/10 while the GeoNutrion are much recent (2018). This may lead to differences in the composition of the maize due to environmental factors (e.g., rainfall) that may influence the results. Testing for sensitivity (e.g., excluding those data point).\n\n\n\n\n\nKumssa, D. B., A. W. Mossa, T. Amede, E. L. Ander, E. H. Bailey, L. Botoman, C. Chagumaira, et al. 2022. “Cereal Grain Mineral Micronutrient and Soil Chemistry Data from GeoNutrition Surveys in Ethiopia and Malawi.” Scientific Data 9 (1, 1): 443. https://doi.org/10.1038/s41597-022-01500-5.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Cleaning maize grain Se concentration in Malawi</span>"
    ]
  },
  {
    "objectID": "predicted-maize.html",
    "href": "predicted-maize.html",
    "title": "5  Methods: Generating predicted maize grain Se concentration for Malawi",
    "section": "",
    "text": "5.1 Exploratory analysis\nHere, we describe all the steps performed to obtain the prediction of maize grain Se concentration in unsampled location of Malawi. The R script (01_maize-model.R) used to run the analysis can be found in the accompanying repository and are an adaptation of the script developed by Prof Murray Lark for the GeoNutrion project which are published here.\nThe data set that we are using is the output generated in the script (00_cleaning-maize.R) which contains the information on crop Se concentration in Malawi. The variables are the GPS sample location (lat/lon), maize grain Se concentration, soil pH and Mean Annual Temperature (MAT) of the two combined datasets (Kumssa et al. (2022), Chilimba et al. (2011)) See Chapter 4 for more information on the data set.\nThen, information for maize only is selected, and some housekeeping actions are performed, such as, removing missing values for the variable of interest (Se_raw) which contains the Se concentration including below detection limits, and transforming zeros into the minimum value. This last operation is performed as log-transformation would be required in subsequent steps.\nCode\n## Choosing only entries with maize Se values\ndata.df &lt;-  subset(data.df, Crop == \"Maize\")\n# Housekeeping: Check NA and zeros\nsum(is.na(data.df$Se_raw))\n\n\n[1] 7\n\n\nCode\nsum(data.df$Se_raw == 0 & !is.na(data.df$Se_raw))\n\n\n[1] 23\n\n\nCode\ndata.df &lt;- subset(data.df, !is.na(Se_raw) & Se_raw&gt;0) #excluding NA & zeros\nNow, we are performing some summary statistics and checking the data skewness to decide on the log-tranformation.\nCode\n# Now create plot name with Se (element of interest)\n\nelement&lt;-\"Se_raw\"\nCrop.target &lt;- \"maize\"\nplotname&lt;-expression(\"Se (raw) /\"~mg~kg^{-1})\nplotname2&lt;-expression(\"Se (raw) /\"~log~mg~kg^{-1})\n\n\n# Compute summary statistics of the selected variable\n\ndata.df  &lt;- as.data.frame(data.df)\n\nsummary&lt;-(summa(data.df[,element]))\nsummary&lt;-rbind(summary,(summa(log(data.df[,element]))))\nrow.names(summary)&lt;-c(\"mg/kg,\",\"log mg/kg\")\nsummaplot((data.df[,element]),plotname)\nDue to the markedly right-side skewness, we decided to log-transform the variable (Se_raw). We can see in the figure below, that the log-transformed concentration of Se in maize is very close to normality, hence we will proceed with the log-trasformed variable for the variogram estimation. Variograms are particularly sensitive to right-side outliers (e.g., exceptionally large values) (Webster and Oliver (2007)).\nCode\n# Checking the data distribution after log-transformation\nsummaplot(log(data.df[,element]),plotname2)\n\n\n\n\n\n\n\n\n\nCode\n# Log-transforming the maize Se conc.\ndata.df[,element]&lt;-log(data.df[, element]) \nplotname&lt;-plotname2\nThen, we can see in Figure 5.1 the log-transformed maize Se concentration coloured by their quartile from the smallest (in blue) to the highest (in red) to see if there are some spatial trend or pattern. We also checked for North to South and West to East trends (see code in the R scripts).\nCode\n# Map of maize Se concentration\n\nquantiles&lt;-as.character(cut(data.df[,element],quantile(data.df[,element],\nc(0,0.25,0.5,0.75,1)),include.lowest=T,\nlabel=c(\"blue\",\"green\",\"yellow\",\"red\")))    \n\n# Classified post-plot\noptions(scipen=5)\nplot(data.df[,\"Longitude\"],data.df[,\"Latitude\"], # Lon & Lat variables\npch=16,col=quantiles,asp=1,\nxlab=\"Longitude\",ylab=\"Latitude\",cex=0.5)\n\n\n\n\n\n\n\n\nFigure 5.1: Map of Malawi: each point represents the maize Se concentration (log-transformed) at a sampled location, the colours show the quantiles: 0-24.9% (blue), 25-49.9% (green), 50-79.9% (yellow), 75-100% (red)",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Methods: Generating predicted maize grain Se concentration for Malawi</span>"
    ]
  },
  {
    "objectID": "predicted-maize.html#exploratory-analysis",
    "href": "predicted-maize.html#exploratory-analysis",
    "title": "5  Methods: Generating predicted maize grain Se concentration for Malawi",
    "section": "",
    "text": "Note\n\n\n\nZeros were excluded due to:\n\nAssumed that maize sample did not contain Se\nLog-transformation of zero is equal to -Inf.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Methods: Generating predicted maize grain Se concentration for Malawi</span>"
    ]
  },
  {
    "objectID": "predicted-maize.html#variogram-estimation-and-validation",
    "href": "predicted-maize.html#variogram-estimation-and-validation",
    "title": "5  Methods: Generating predicted maize grain Se concentration for Malawi",
    "section": "5.2 Variogram estimation and validation",
    "text": "5.2 Variogram estimation and validation\nAfter the data exploration, the next step is selecting the best estimators to fit the model (ordinary kriging (OK)) for getting the most accurate results.\nThe method for evaluating and selecting the model was based on (gashuNutritionalQualityCereals2021?) and best practices suggested by and Webster and Oliver (2007).\n\n5.2.1 Obtaining the variogram estimates\nIn this section, we are studying the spatial structure of the data by generating an empirical variogram.\nTo do so, first we need to calculate some information from the data: the distance between all pairs of observations (lag) and the difference in maize Se concentration between two observations (varogram cloud).\n\n\nCode\n#  Exploratory study of empirical variogram\n\n#  Make a variogram cloud\n\nN&lt;-nrow(data.df) # No. of observations\n\nNP&lt;-0.5*N*(N-1)  # No. of pairs\n\n# Extracting variables from the data set\nLong&lt;-data.df$Longitude # Lon\nLat&lt;-data.df$Latitude # Lat\nz&lt;-data.df[,element]  # maize Se conc.\n\n# Generating vectors to store the data to be calculated in the loop below\nlag&lt;-vector(\"numeric\",NP)   # Distance between 2pts (lag)\nvclo&lt;-vector(\"numeric\",NP)  # Variogram cloud \nbear&lt;-vector(\"numeric\",NP)  # Shortest distance between 2pts (on an ellipsoid or sphere)\n\nico=0\n\nfor (i in 1:(N-1)){\nfor (j in (i+1):N){\nico=ico+1\n# print(ico/NP)\nlag[ico]&lt;-distVincentySphere(c(Long[i],Lat[i]),c(Long[j],Lat[j]))/1000 #\nbear[ico]&lt;-finalBearing(c(Long[i],Lat[i]),c(Long[j],Lat[j]), a=6378137, f=1/298.257223563, sphere=TRUE)\nzi&lt;-(z[i])\nzj&lt;-(z[j])\nvclo[ico]&lt;-(zi-zj)\n}\n}\n\n\nWith that information, we are going to decide on the maximum lag distance that will be included in the variogram, and the lag bins. For more information about the use of bin distance (d) and the importance of its selection, see “Irregular sampling in one dimension” (Webster and Oliver (2007), page 68).\n\n\nCode\n# Setting for the variogram:\n# max. distance (e.g., end of spatial correlation) around 100km \n# We have tested 100km, 150km and 200km \nmaxdist &lt;- 100\n\nlagbins&lt;-cut(lag,seq(0,maxdist,10),labels=seq(5,maxdist,10))   # 10-km bins for Malawi\n\nlag2&lt;-lag[!is.na(lagbins)]\nvclo2&lt;-vclo[!is.na(lagbins)]\nlagbins&lt;-factor(lagbins[!is.na(lagbins)])\nnlags&lt;-nlevels(lagbins)\n\n\nThen, calculating the semi-variance we are using three different estimators: isotropic Matheron (Ma), Cressie-Hawkins (CH) and Dowd (Do).\nIn order to store the data we created three matrices, one semivar which contains the variogram estimates and was structured as follow:\n\ncolumn 1 are estimates with Matheron (iso-Ma),\ncolumns 2 are for the robust estimator Cressie-Hawkins (iso-CH),\ncolumns 3 are for the robust Dowd estimator (iso-Do).\n\nThen, the lag pairs per bin, and the mean lag distance were stored in the objects npair and varlag (isotropic).\n\n\nCode\n# Matrices for storing the results\nsemiv&lt;-matrix(nrow=nlags,ncol=3)\nnpair&lt;-matrix(nrow=nlags,ncol=1)\nvarlags&lt;-matrix(nrow=nlags,ncol=1)\n\ncolnames(semiv)&lt;-c(\"iso-Ma\",\"iso-CH\",\"iso-Do\")\ncolnames(npair)&lt;-c(\"iso\")\ncolnames(varlags)&lt;-c(\"iso\")\n\n\nNow the mean distance per lag bin and the number of pairs in each lag (total/mean = n) and the estimators are calculated.\n\n\nCode\n# Adding the mean lag distance per bin \nvarlags[,1]&lt;-as.numeric(by(lag2, lagbins, mean))\n# Adding the number of pairs in each lag bin \nnpair[,1]&lt;-as.numeric(by(lag2, lagbins, sum))/as.numeric(by(lag2, lagbins, mean))\n\n# Calculating the estimator\n\n#  Matheron\nsemiv[,1]&lt;-0.5*(as.numeric(by((vclo2)^2, lagbins, mean)))\n\n# CH\nsemiv[,2]&lt;-(as.numeric(by((sqrt(abs(vclo2))), lagbins, mean)))^4\nsemiv[,2]&lt;-0.5*semiv[,2]/(0.457+0.459/npair[,1]+0.045/npair[,1]^2)\n\n# Do\nvclo2d&lt;-c(vclo2,-vclo2)\nlagbinsd&lt;-c(lagbins,lagbins)\n\nsemiv[,3]&lt;-0.5*(as.numeric(by(vclo2d, lagbinsd, mad)))^2\n\n\nAnd then, results are plotted…\n\n\nCode\n#  Now plot the variograms\nmaxv&lt;-max(semiv[,1:3])\nminv&lt;-min(semiv[,1:3])\n\nplot(varlags,semiv[,1],ylim=c(0,maxv),xlab=\"Distance /km\",ylab=\"Variance\",pch=16)\npoints(varlags,semiv[,2],pch=1)\npoints(varlags,semiv[,3],pch=17)\n\nlocsv&lt;-minv*c(0.6,0.4,0.2)\npoints(60,locsv[1],pch=16)\npoints(60,locsv[2],pch=1)\npoints(60,locsv[3],pch=17)\n\ntext(65,locsv[1],\"Matheron\",pos=4)\ntext(65,locsv[2],\"Cressie-Hawkins\",pos=4)\ntext(65,locsv[3],\"Dowd\",pos=4)\n\n\n\n\n\n\n\n\n\n\n\n5.2.2 Fit exponential variogram functions to each set of estimates\nFirst, we need to choose initial estimates for the parameters. These will impact the estimates, so also should they be chosen with care! (See Chapter 6 and page 101 of Webster and Oliver (2007)).\n\n\nCode\n# Reasonable initial estimates of the parameters must be entered below\n\nco&lt;-20000\nc1&lt;-30000\na&lt;-50\n\nmaxl&lt;-max(varlags)*1.1\npar(mfrow=c(2,2))\n\n\nThen, we are fitting the model using the different estimators using weighted least squares (See the wls() function in the kringing-functions.R script under the functions folder).\n\n\nCode\n# Matheron's estimator (Ma)\n\nh&lt;-varlags[,1] # mean lag distance per bin \nsv&lt;-semiv[,1]  # Ma semivariance\nnpa&lt;-npair[,1] # No of pairs per bin\nkap&lt;-0.5\n\n# Fitting the model \noo&lt;-optim(c(co,c1,a),wls\n,method=\"L-BFGS-B\",\nlower=c(0.0,0.0,0),\nupper=c(1000000,1000000,5000))\n\nAhat&lt;-length(h)*log(oo$value)+6  \n\nooMa&lt;-oo # Storing values \n\n\nVisually inspecting the results of the fitted variogram for the Matheron’s estimator.\n\n\nCode\nplot(varlags[,1],semiv[,1],ylim=c(0,maxv),xlim=c(0,maxl),xlab=\"Distance /km\",ylab=\"Variance\",pch=16)\nlines(seq(0,maxl,0.1),oo$par[1]+oo$par[2]*(1-exp(-seq(0,maxl,0.1)/oo$par[3])))\n\nmtext(\"a). Matheron\",3,adj=0,line=0.5)\n\n\n\n\n\n\n\n\n\n\n\nThen, we fitted the varigram using the Cressie’s and Hawkins’s estimators.\n\n\nCode\n# Cressie's and Hawkins's estimator  (CH)\n\nh&lt;-varlags[,1] # mean lag distance per bin \nsv&lt;-semiv[,2]  # CH semivariance\nnpa&lt;-npair[,1] # No of pairs per bin\nkap&lt;-0.5\n\n# Fitting the model \noo&lt;-optim(c(co,c1,a),wls\n,method=\"L-BFGS-B\",\nlower=c(0.0,0.0,0),\nupper=c(1000000,1000000,5000))\n\nAhat&lt;-length(h)*log(oo$value)+6  \n\nooCH&lt;-oo # Storing values \n\n\nAgain, we proceed to visually inspect the fitted variogram.\n\n\nCode\n# Plotting the data\nplot(varlags[,1],semiv[,2],ylim=c(0,maxv),xlim=c(0,maxl),xlab=\"Distance /km\",ylab=\"Variance\",pch=16)\nlines(seq(0,maxl,0.1),oo$par[1]+oo$par[2]*(1-exp(-seq(0,maxl,0.1)/oo$par[3])))\nmtext(\"b). Cressie-Hawkins\",3,adj=0,line=0.5)\n\n\n\n\n\n\n\n\n\n\n\nAnd, finally, we fitted the variogram using the Dowd’s estimator.\n\n\nCode\n# Dowd's estimator Do\n\nh&lt;-varlags[,1] # mean lag distance per bin \nsv&lt;-semiv[,3]  # Do semivariance\nnpa&lt;-npair[,1] # No of pairs per bin\nkap&lt;-0.5\n\n# Fitting the model \noo&lt;-optim(c(co,c1,a),wls\n,method=\"L-BFGS-B\",\nlower=c(0.0,0.0,0),\nupper=c(1000000,1000000,5000))\n\nAhat&lt;-length(h)*log(oo$value)+6  \n\nooDo&lt;-oo # Storing values \n\n\nVisualising the results….\n\n\nCode\nplot(varlags[,1],semiv[,3],ylim=c(0,maxv),xlim=c(0,maxl),xlab=\"Distance /km\",ylab=\"Variance\",pch=16)\nlines(seq(0,maxl,0.1),oo$par[1]+oo$par[2]*(1-exp(-seq(0,maxl,0.1)/oo$par[3])))\n\nmtext(\"c). Dowd\",3,adj=0,line=0.5)\n\n\n\n\n\n\n\n\n\n\n\n\n\n5.2.3 Cross-validation\nCross-validation consists in estimating the sample points at a time by leaving one observation out. It was performed using a subset of the data, for our case, we used 1,000 observations.\n\n\nCode\nN&lt;-nrow(data.df) # No. of observations\n\nNv&lt;-500 # vs 1000 check perc.\n\nkvop&lt;-matrix(nrow=Nv,ncol=5)\n\nNr&lt;-Nv-1\n\n# Make random sample without replacement\nsam&lt;-sample(1:N,Nv,replace=F)\n\n# Sub sample data\nLong_s&lt;-Long[sam]\nLat_s&lt;-Lat[sam]\nz_s&lt;-(z[sam])\n\n\nAfter, getting the subset of the sample, we repeat the step 1 just for the sub-sample, i.e, calculating the distance matrix (e.g., pair distances).\n\n\nCode\n# Compute distance matrix for subsample\n\nDM&lt;-matrix(0,nrow=Nv,ncol=Nv)\n\nfor (i in 1:(Nv-1)){\nfor (j in (i+1):Nv){\nDM[i,j]&lt;-distVincentySphere(c(Long_s[i],Lat_s[i]),c(Long_s[j],Lat_s[j]))/1000 #WGS84 ellipsoid is used by default\nDM[j,i]&lt;-DM[i,j]\n}\n}\n\n\nNow, we are performing the cross-validation for the three estimators.\nFirst, we chose the parameters of the model fitted using the Matheron estimator.\n\n\nCode\n#Select parameter set to validate\n\nooX&lt;-ooMa  # Matheron\n\n# variogram matrix\n\nGam&lt;-ooX$par[1]+ooX$par[2]*(1-matern(DM,ooX$par[3],0.5))\ndiag(Gam)&lt;-0\n\nfor (i in 1:Nv){\n\n# print(i)\n\nA&lt;-Gam[-i,-i]\nA&lt;-cbind(A,rep(1,Nr))\nA&lt;-rbind(A,c(rep(1,Nr),0))\n\nz_0&lt;-z_s[i]\nz_n&lt;-z_s[-i]\n\nb&lt;-c(Gam[i,-i],1)\n\nlam&lt;-solve(A)%*%b\nZhat&lt;-sum(z_n*lam[1:Nr])\nerr&lt;-z_0-Zhat\nkv&lt;-t(b)%*%lam\ntheta&lt;-(err^2)/kv\n\nkvop[i,]&lt;-c(z_0,Zhat,err,kv,theta)\n}\n\n\nThen, an exploratory plot of prediction errors is produced for the variogram, and store the validation outputs for later use.\n\n\nCode\n# Visualising the error \ndev.new()\nsummaplot(kvop[,3],\"Kriging error\")\n\n# Storing the values\nkvopMa&lt;-kvop\ncolnames(kvopMa)&lt;-c(\"z_0\",\"Zhat\",\"err\",\"kv\",\"theta\")\n\n\n\n\n\n\n\n\n\n\n\nThen, we repeated the same operation for the model fitted with Cressie & Hawkins estimator.\n\n\nCode\n#Select parameter set to validate\n\nooX&lt;-ooCH\n\n# variogram matrix\n\nGam&lt;-ooX$par[1]+ooX$par[2]*(1-matern(DM,ooX$par[3],0.5))\ndiag(Gam)&lt;-0\n\nfor (i in 1:Nv){\n\n# print(i)\n\nA&lt;-Gam[-i,-i]\nA&lt;-cbind(A,rep(1,Nr))\nA&lt;-rbind(A,c(rep(1,Nr),0))\n\nz_0&lt;-z_s[i]\nz_n&lt;-z_s[-i]\n\nb&lt;-c(Gam[i,-i],1)\n\nlam&lt;-solve(A)%*%b\nZhat&lt;-sum(z_n*lam[1:Nr])\nerr&lt;-z_0-Zhat\nkv&lt;-t(b)%*%lam\ntheta&lt;-(err^2)/kv\n\nkvop[i,]&lt;-c(z_0,Zhat,err,kv,theta)\n}\n\n\nAnd, visusalise and store the values.\n\n\nCode\n# Visualising the error\ndev.new()\nsummaplot(kvop[,3],\"Kriging error\")\n\n# Storing the values\nkvopCH&lt;-kvop\ncolnames(kvopCH)&lt;-c(\"z_0\",\"Zhat\",\"err\",\"kv\",\"theta\")\n\n\n\n\n\n\n\n\n\n\n\nFinally, we repeated the operation for Dowd.\n\n\nCode\n#Select parameter set to validate\n\nooX&lt;-ooDo\n\n# variogram matrix\n\nGam&lt;-ooX$par[1]+ooX$par[2]*(1-matern(DM,ooX$par[3],0.5))\ndiag(Gam)&lt;-0\n\nfor (i in 1:Nv){\n\n#print(i)\n\nA&lt;-Gam[-i,-i]\nA&lt;-cbind(A,rep(1,Nr))\nA&lt;-rbind(A,c(rep(1,Nr),0))\n\nz_0&lt;-z_s[i]\nz_n&lt;-z_s[-i]\n\nb&lt;-c(Gam[i,-i],1)\n\nlam&lt;-solve(A)%*%b\nZhat&lt;-sum(z_n*lam[1:Nr])\nerr&lt;-z_0-Zhat\nkv&lt;-t(b)%*%lam\ntheta&lt;-(err^2)/kv\n\nkvop[i,]&lt;-c(z_0,Zhat,err,kv,theta)\n}\n\n\nAnd, visualising and storing.\n\n\nCode\n# Visualising the error\ndev.new()\nsummaplot(kvop[,3],\"Kriging error\")\n#summa(kvop[,5])\n\n# Storing the values\nkvopDo&lt;-kvop\ncolnames(kvopDo)&lt;-c(\"z_0\",\"Zhat\",\"err\",\"kv\",\"theta\")\n\n\n\n\n\n\n\n\n\n\n\nWe then checked the mean and median standardised squared prediction error for each variogram.\nThe median for Matheron was just outside the median standardised squared prediction error interval (thetaCLL, thetaCLU) calculated below. Then, when we compared the other robust estimators, both medians were in range, with Dowd closest to 0.455.\n\n\nCode\n# checking the theta (MSER)\nsumma(kvopMa[,5])[,c(1,2)]\nsumma(kvopCH[,5])[,c(1,2)]\nsumma(kvopDo[,5])[,c(1,2)]\n\nthetaCLU&lt;-0.455+2*sqrt(1/(8*(Nv/2)*(dchisq(0.455,1))^2))\nthetaCLL&lt;-0.455-2*sqrt(1/(8*(Nv/2)*(dchisq(0.455,1))^2))\n\nprint(c(thetaCLL,thetaCLU))\n\n\nHence that was the model parameters chosen for the kriging predictions at unsampled locations.\n\n\nCode\n# For our maize Se data (log-transformed) Do was\n# the better performing\nooX&lt;-ooDo \n\n\nValidation outputs were saved for the estimators of Matheron (kvopMA), Cressie & Hawkins (kvopCH) and Dowd (kvopDo) respectively (see R script:01_maize-model.R).",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Methods: Generating predicted maize grain Se concentration for Malawi</span>"
    ]
  },
  {
    "objectID": "predicted-maize.html#predicting-maize-grain-se-concentrations-in-unsampled-locations",
    "href": "predicted-maize.html#predicting-maize-grain-se-concentrations-in-unsampled-locations",
    "title": "5  Methods: Generating predicted maize grain Se concentration for Malawi",
    "section": "5.3 Predicting maize grain Se concentrations in unsampled locations",
    "text": "5.3 Predicting maize grain Se concentrations in unsampled locations\nAfter choosing the optimal estimator, we used it for predicting the maize Se concentration in unsampled locations in Malawi using ordinary kriging.\nFirst, we need to load the target locations, which are all the unsampled locations in Malawi (n=178,040). It was obtained by dividing the country in even squares at resolution.\nThen, we need to calculate the matrix distance (i.e., the distance between each point location in our target sample) and the variogram matrix for the sampled data as performed previously.\n\n\nCode\n# Loading the data with the unsampled locations\ntargets.df&lt;-read.csv(here::here(\"data\", \"maize\", \"Malawi_targets.csv\"),header=T) \n\n# Sampled location data\nurdata.df&lt;-data.frame(cbind(Lat,Long,z))\n\n# Make a distance matrix among all data points \n\nLong&lt;-urdata.df$Long\nLat&lt;-urdata.df$Lat\n\nDM&lt;-matrix(0,nrow=N,ncol=N)\n\nfor (i in 1:(N-1)){\nfor (j in (i+1):N){\n\nDM[i,j]&lt;-distVincentySphere(c(Long[i],Lat[i]),c(Long[j],Lat[j]))/1000 #WGS84 ellipsoid is used by default\nDM[j,i]&lt;-DM[i,j]\n}\n}\n\n# variogram matrix\n\nGam&lt;-ooX$par[1]+ooX$par[2]*(1-matern(DM,ooX$par[3],0.5))\n\nA&lt;-Gam\nA&lt;-cbind(A,rep(1,N))\nA&lt;-rbind(A,c(rep(1,N),0))\nAinv&lt;-solve(A)\n\n\nWe prepared the unsampled data set for making the prediction.\n\n\nCode\n# No of unsampled obs.\nNt&lt;-nrow(targets.df)\n\n# Matrix to store the data from the OK\nkrop&lt;-matrix(nrow=Nt,ncol=5)\n\n# Binding all the sampled locations\nAllpoints&lt;-cbind(Lat,Long)\n\n\nFinally, we performed the prediction. Note that the outputs are the locations (Long/Lat), the log-tranformed predicted value for each location, the log-transformed kriging variance and the Lagrange multiplier. The later one is important because as reported previously (@), the back transformation of the lognormal kriging for ordinary kriging need to be done using the following Equation 5.1:\nLet \\(x\\) denote the number of eruptions in a year. Then, \\(x\\) can be modeled by a Poisson distribution\n\\[\nZ_{OK}(x_0) = exp(Y_{OK}(x_0) + Var_{OK}(x_0)/2 - \\lambda(x_0))\n\\tag{5.1}\\]\nWhere \\(Z_{OK}(x_0)\\) is the back transformed variable at a given point \\((x_0)\\), \\(Y_{OK}(x_0)\\) and \\(Var_{OK}(x_0)\\) are the predicted log-transformed variable (maize Se concentration) and its variance using ordinary kriging at the same location, respectively, and \\(\\lambda(x_0)\\) is the Lagrange multiplier.\nNote that the prediction will take some time to run, hence, after finishing, we will save the file, before proceeding to back-transforming the data.\n\n\nCode\n# OK prediction\n\nfor (it in 1:Nt){\nprint(c(it,Nt))\n\n# Extract Lat and Long of target point \n\nLat_t&lt;-targets.df$Lat[it]\nLong_t&lt;-targets.df$Long[it]\n\nBd&lt;-matrix(nrow=(N+1),ncol=1)\n\nfor (j in 1:N){\nBd[j]&lt;-distVincentySphere(c(Long[j],Lat[j]),c(Long_t,Lat_t))/1000\n}\n\n#maxdis&lt;-max(Bd[1:Ne])\n#print(c(it,it/Nt,maxdis))\n\nBd[1:N]&lt;-ooX$par[1]+ooX$par[2]*(1-matern(Bd[1:N],ooX$par[3],0.5))\nBd[N+1]&lt;-1\nlam&lt;-Ainv%*%Bd\nZhat&lt;-sum(z*lam[1:N])\nkv&lt;-t(Bd)%*%lam\nlagr&lt;-lam[N+1]\nkrop[it,]&lt;-c(Long_t,Lat_t,Zhat,kv,lagr)\n}\n\n# Back-transforming lognormal OK\nkrop$Zhat_exp &lt;- exp(krop$Zhat + krop$kv/2 - krop$lagr)\n\n# Saving exponential OK\nfname&lt;-paste(\"data/OK/\",paste(Sys.Date(), element,\"_OK_exp\",Crop.target,\".csv\",sep=\"\"))\n\nwrite.csv(krop,fname,row.names=F)  \n\n\nFinally, we had to back-transform the data and saved the output in the data folder.\n\n\n\n\nChilimba, Allan D. C., Scott D. Young, Colin R. Black, Katie B. Rogerson, E. Louise Ander, Michael J. Watts, Joachim Lammel, and Martin R. Broadley. 2011. “Maize Grain and Soil Surveys Reveal Suboptimal Dietary Selenium Intake Is Widespread in Malawi.” Scientific Reports 1 (1, 1): 72. https://doi.org/10.1038/srep00072.\n\n\nKumssa, D. B., A. W. Mossa, T. Amede, E. L. Ander, E. H. Bailey, L. Botoman, C. Chagumaira, et al. 2022. “Cereal Grain Mineral Micronutrient and Soil Chemistry Data from GeoNutrition Surveys in Ethiopia and Malawi.” Scientific Data 9 (1, 1): 443. https://doi.org/10.1038/s41597-022-01500-5.\n\n\nWebster, Richard, and Margaret A Oliver. 2007. Geostatistics for Environmental Scientists.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Methods: Generating predicted maize grain Se concentration for Malawi</span>"
    ]
  },
  {
    "objectID": "data-processing.html",
    "href": "data-processing.html",
    "title": "6  Methods: Data processing",
    "section": "",
    "text": "6.1 Maize aggregation using observed maize dataset\nOnce the datasets are selected and cleaned. The next steps are the preparation of the variables that are going to be used in the model. Particularly, generating the different estimates of maize grain Se concentration for each aggregation level that will be compared with the plasma Se concentration in Malawian women.\nThe datasets that we used are listed below:",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Methods: Data processing</span>"
    ]
  },
  {
    "objectID": "data-processing.html#maize-aggregation-using-observed-maize-dataset",
    "href": "data-processing.html#maize-aggregation-using-observed-maize-dataset",
    "title": "6  Methods: Data processing",
    "section": "",
    "text": "6.1.1 Cluster-level mean of the observed maize Se\n\n6.1.1.1 Identifying enumeration areas of the maize grain sample locations\nSimilarly, in the maize grain Se dataset, the EAs were not available for each sample point. Therefore, in order to calculate the mean/media maize Se concentration for each administrative unit, we need to link the dataset with the administrative boundaries of Malawi (ea_admin) with the maize grain Se dataset (maize.df).\nHere, we could, as first step, identify the EAs where each maize grain were sampled. This could be easily done for the observed dataset as the number of samples are still small. On the other hand, for the predicted maize grain Se dataset, this spatial joint may take very long. Therefore, because the objective is to provide maize grain Se values for the aggregation units with plasma Se values, we could use the cluster-EAs, the districts, and the buffered areas.\nTo do so, we used the spatial join, as it was done for the plasma.df.\n\n\nCode\n# Checking the class of the two datasets\nclass(ea_admin)\n\n\n[1] \"sf\"         \"data.frame\"\n\n\nCode\nclass(maize.df)\n\n\n[1] \"data.frame\"\n\n\nWe can see that the maize grain dataset is not a spatial object. Therefore, we need to be transformed into one, which will be now be the geomaize.df.\n\n\nCode\n# Transforming maize data.frame into a spatial object (geometry) \ngeomaize.df &lt;- st_as_sf(maize.df,\n              coords =c(\"Longitude\", \"Latitude\"), crs = \"EPSG:4326\")\n\n# Adding a variable to store info on distance \ngeomaize.df$dist_in_m &lt;- NA\n\n# Checking effect of the transformation\nclass(geomaize.df)\n\n\n[1] \"sf\"         \"data.frame\"\n\n\nAfter checking that the geomaize.df is the correct class. We can proceed to merging the two spatial datasets.\n\n\nCode\n# Getting info on the admin boundaries (EA/district level)\n# Allocating Se values to each admin unit\ngeomaize_ea.df  &lt;-  st_join(geomaize.df, ea_admin)\n\n\nThere were some maize grain samples (n=5) without a corresponding EA. This was because some of the GPS location were incorrect/inaccurate (i.e., one sample location lied outside Malawi boundaries), or due to lying in outside boundaries as it is shown in the map below by the red dots (Figure 6.1).\n\n\nCode\n# Storing data of the maize Se samples w/o EAs\nmissing  &lt;- geomaize_ea.df[which(is.na(geomaize_ea.df$EACODE)),]\n\n# Plotting maize Se sample falling out EAs\ntm_shape(ea_bnd) +\ntm_polygons() +\ntm_shape(missing) +\ntm_symbols(col =\"red\", size =0.1)\n\n\n\n\n\n\n\n\nFigure 6.1: Map of Malawi divided by Enumeration Areas (EAs) and the red points representing the maize grain Se samples outside EA boundaries.\n\n\n\n\n\nInstead of removing the observations, we decided to allocated them to the closest EA (in m). The information on how far (in m) were from the EA that were allocated to, was also stored in the new variable that was generated in previous steps: dist_in_m.\n\n\nCode\n# Fixing missing (EAs for maize Se values) \nm &lt;-  c(90, 200, 300, 4500)\n\nfor(i in 1:length(m)){\n\ngeomaize_ea.df[which(is.na(geomaize_ea.df$EACODE)), \"dist_in_m\"] &lt;- m[i]\n  \ngeomaize_ea.df[which(is.na(geomaize_ea.df$EACODE)),]  &lt;-  st_join(geomaize_ea.df[which(is.na(geomaize_ea.df$EACODE)),1:ncol(geomaize.df)-1], \n    ea_admin, st_is_within_distance,  dist = units::set_units(m[i], \"m\")) \n\n}\n\n\nFinally, the maize grain dataset was ready for calculating the mean/median Se concentration at the different administrative boundaries and was stored into as intermediary output for further analysis. Before saving the dataset, it was transformed back into a data frame by removing the geometry and adding back the information about the samples locations as coordinates (longitude and latitude).\n\n\nCode\n# Converting back from spatial obj to dataframe\nmaize.df  &lt;- geomaize_ea.df  %&gt;% st_drop_geometry()  %&gt;%  #removing geometry\n            right_join(., maize.df)  # adding back the long/lat variable\n\n\n\n\nCode\n# Saving dataset with aggregation unit for modelling \nsaveRDS(maize.df, here::here(\"data\", \"inter-output\",\n                             \"mwi_maize-se-raw_admin.RDS\"))\n\n\nAfter the dataset are prepared and the spatial aggregation level datasets are ready, we can proceed to calculate the aggregation of maize grain Se at the different aggregation levels. Those were calculated using the script (01_maize-aggregation.R) and are described in subsequent sections.\n\n\n6.1.1.2 Aggregation of the data\nFirst, we are getting the cluster-EA information for which we would need the maize Se concentration.\n\n\nCode\n# Cluster's EA info\ncluster.df &lt;- cluster.df %&gt;% \n  distinct(survey_cluster1, EACODE, ADM2_PCODE, ADM2_EN, urbanity)\n\n\nWe have already identified in which EAs the observed maize dataset are in in the Section 6.1.1.1, as shown in the ?fig-map3. Therefore, we only need to merge the two dataset, and get the maize Se concentration for each EA within each cluster.\n\n\nCode\n# Merge cluster's EA and observed maize\nmaize_cluster &lt;- maize.df %&gt;% right_join(., cluster.df) \n\n# Visualising the maize Se conc. per cluster\nboxplot(maize_cluster$Se_raw ~ maize_cluster$survey_cluster1)\n\n\n\n\n\n\n\n\n\nIn the boxplot, we can see that the variability of maize grain Se concentration is quite different for each cluster, which may lead to some high intra-cluster variability.\nThen, we calculated the mean, median, standard deviation (SD) and interquartile range (IQR) of the maize Se concentration for each cluster.\n\n\nCode\n# Calculating the maize grain Se conc per cluster\nmaize_cluster &lt;- maize_cluster %&gt;% \n  group_by(survey_cluster1) %&gt;% \n  summarise(Se_mean = mean(Se_raw, na.rm = TRUE), \n            Se_sd = mean(Se_raw, na.rm = TRUE), \n            Se_median = median(Se_raw, na.rm = TRUE), \n            Se_iqr = IQR(Se_raw, na.rm = TRUE), \n            Se_n = n())\n\ndatatable(maize_cluster, filter = \"top\")\n\n\n\n\n\n\nWe can see that there were 4 clusters without any maize Se concentration, this is because there were no samples collected for any of the EAs within that clusters. We identified the clusters without any observed maize Se concentration value.\n\n\nCode\n# Getting the cluster with missing values \nmiss &lt;-  unique(maize_cluster$survey_cluster1[is.na(maize_cluster$Se_mean)])\n\n\n\n\n6.1.1.3 Missing values\nWe need at least one maize Se value per cluster to be compared with the plasma Se. However, there were four clusters (200, 276, 497, 777) from the plasma Se dataset (plasma.df) that did not match with any of the EAs in the observed Se maize grain dataset (maize.df). Hence, the approach taken was the following:\n\n\nCode\n# Selecting only the EAs that were included in the missing clusters\n ea_cluster &lt;- cluster.df %&gt;% filter(survey_cluster1 %in% miss) %&gt;% \n   distinct(EACODE) %&gt;% left_join(., ea_admin) %&gt;% st_as_sf()\n\n\nFirstly, we identified the EAs that were included in each of the missing clusters (n=1.0402005^{7}, 1.0402006^{7}, 1.0406001^{7}, 1.0406002^{7}, 2.0652013^{7}, 2.0666005^{7}, 2.0631007^{7}, 2.0631008^{7}, 2.0666004^{7}, 2.065201^{7}, 2.0652012^{7}, 2.0666002^{7}, 2.0666006^{7}, 2.0631002^{7}, 2.0638018^{7}, 2.0666009^{7}, 2.0667001^{7}, 2.0633003^{7}, 2.0631003^{7}, 2.0631004^{7}, 2.0631005^{7}, 2.0675001^{7}, 2.0631006^{7}, 2.0652009^{7}, 2.0666003^{7}, 2.0666001^{7}, 2.0666007^{7}, 2.0611021^{7}, 2.0666008^{7}, 2.0612001^{7}, 3.0806042^{7}, 3.0806041^{7}, 3.0806023^{7}, 3.0403027^{7}, 3.0806029^{7}, 3.080603^{7}, 3.0403028^{7}, 3.0806031^{7}, 3.0806032^{7}, 3.0403043^{7}, 3.0806036^{7}, 3.0403062^{7}, 3.0806035^{7}, 3.0806033^{7}, 3.0403063^{7}, 3.0806034^{7}, 3.0403065^{7}, 3.0806039^{7}, 3.080604^{7}, 3.0403066^{7}, 3.0403067^{7}, 3.1106001^{7}, 3.1001092^{7}, 3.1106003^{7}, 3.1001093^{7}, 3.1106002^{7}, 3.1001094^{7}, 3.1106006^{7}, 3.1001095^{7}, 3.1106007^{7}, 3.1106009^{7}, 3.1106005^{7}, 3.1001098^{7}, 3.110601^{7}, 3.1106008^{7}, 3.1106011^{7}).\nSecondly, we assigned the closest data point (i.e, maize grain Se conc. value) for each EA. To do so, we created a loop that finds the closest data point 20m increment each time for all the EAs and it store the distance for future reference.\n\n\nCode\nfor(i in 1:nrow(ea_cluster)){\n  \n  m &lt;- 230\n  \n  if(sum(ls()==\"missing\")==0){\n    missing &lt;- test\n  }\n  \n  missing &lt;- rbind(missing, test)\n  \n  print(nrow(missing))\n  \nrepeat {\n\nm &lt;- m + 20 \n\n  test &lt;- st_join(geomaize.df, ea_cluster[i,], st_is_within_distance,  \n          dist = units::set_units(m, \"m\")) %&gt;% \n          filter(!is.na(EACODE))%&gt;% \n          mutate(dist_in_m = m)\n  \n  print(i)\n  print(m)\n  \n  if(nrow(test)&gt;0) { break}  \n    \n}\n\n}\n\n# Saving output of the loop\nmissing %&gt;% st_drop_geometry() %&gt;%\n  saveRDS(., here::here(\"data\", \"inter-output\", \"filling-missing-Se-observed-maize.RDS\"))\n\n\nNote that we are starting at 230m distance because we found th first match at 250m.\nAt least one maize Se concentration value was found per each EA, however we only need, at least, one value per cluster and hence, a number of possibilities of dealing with the multiple matches were considered, and are described below.\n\n\nCode\nmissing &lt;- readRDS(here::here(\"data\", \"inter-output\", \"filling-missing-Se-observed-maize.RDS\"))\n\ncluster.df  %&gt;% \n  filter(survey_cluster1 %in% miss) %&gt;% left_join(., missing) %&gt;% \n  select(survey_cluster1, urbanity,EACODE,ADM2_EN, dist_in_m, Se_raw) %&gt;% \n group_by(survey_cluster1) %&gt;% \n  summarise(Se_mean = mean(Se_raw, na.rm = TRUE), \n            Se_sd = sd(Se_raw, na.rm = TRUE), \n            dist_mean = mean(dist_in_m, na.rm = TRUE), \n            dist_sd = sd(dist_in_m, na.rm = TRUE))\n\n\n# A tibble: 4 × 5\n  survey_cluster1 Se_mean   Se_sd dist_mean dist_sd\n            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;\n1             200 0.318   0.0897      2929.   1796.\n2             276 0.0256  0.0143      3348.   2005.\n3             497 0.00344 0.00252     4950    3255.\n4             777 0.0245  0.00856     6441.    959.\n\n\nFirstly, we considered using the mean/ median of all EA values per cluster, however there were many repeated values. For instance, the closest data point for 11 (out of 15) EAs within the cluster 200 were the same maize sample (Se= 0.344mcg/kg) as it is shown in Figure 6.2. Hence, we decided to exclude duplicated samples to keep consistency with the whole sample.\n\n\nCode\ncluster.df  %&gt;% \n  filter(survey_cluster1 %in% miss) %&gt;% left_join(., missing) %&gt;% \n  arrange(survey_cluster1, dist_in_m) %&gt;% \n  select(survey_cluster1, urbanity,EACODE,ADM2_EN, dist_in_m, Se_raw) %&gt;% \n  ggplot(aes(Se_raw, fill=as.character(survey_cluster1))) + \n  geom_histogram() + scale_fill_discrete(name = \"Cluster\") +\n  theme_bw() + facet_wrap(~survey_cluster1) \n\n\n\n\n\n\n\n\nFigure 6.2: Histogram of the closest maize Se concentration for each EA in each of the missing cluster.\n\n\n\n\n\nThen, we tried using those values within buffered range (i.e.,2.5km for urban and 5km for rural).\n\n\nCode\ncluster.df  %&gt;% \n  filter(survey_cluster1 %in% miss) %&gt;% left_join(., missing) %&gt;% \n  select(survey_cluster1, urbanity, EACODE,ADM2_EN, dist_in_m, Se_raw) %&gt;% filter((urbanity == \"1\" & dist_in_m &lt;2500) | (urbanity == \"2\" & dist_in_m &lt;5000)) %&gt;% \n group_by(survey_cluster1) %&gt;% \n  summarise(Se_mean = mean(Se_raw, na.rm = TRUE), \n            Se_sd = sd(Se_raw, na.rm = TRUE), \n            dist_mean = mean(dist_in_m, na.rm = TRUE), \n            dist_sd = sd(dist_in_m, na.rm = TRUE),\n             dist_max =max(dist_in_m, na.rm = TRUE))\n\n\n# A tibble: 3 × 6\n  survey_cluster1 Se_mean   Se_sd dist_mean dist_sd dist_max\n            &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;\n1             200 0.311   0.101       2172.   1112.     4190\n2             276 0.0262  0.0150      2466.   1215.     4510\n3             497 0.00344 0.00309     2250     537.     2630\n\n\nHowever, this approach yield zero values for the cluster 777 which corresponds to Lilongwe city, as shown in Figure 6.3.\n\n\nCode\ncluster.df  %&gt;% \n  filter(survey_cluster1 %in% miss) %&gt;% left_join(., missing) %&gt;% \n  arrange(survey_cluster1, dist_in_m) %&gt;% \n  select(survey_cluster1, urbanity,EACODE,ADM2_EN, dist_in_m, Se_raw) %&gt;% \n  ggplot(aes(Se_raw, dist_in_m, colour=as.character(ADM2_EN))) + \n  geom_point(aes(size=Se_raw))  +  \n  labs(size=\"Maize Se conc.(mcg/kg)\", colour=\"District\") +\n  theme_bw() + facet_wrap(~survey_cluster1) \n\n\n\n\n\n\n\n\nFigure 6.3: Graph showing the distance and concentration of the closest maize Se samples for each EA in each of the missing cluster.\n\n\n\n\n\nFinally, we identified the closest data point (the closest maize sample with Se values) in the dataset for each of the four cluster.\n\n\nCode\ncluster.df  %&gt;% \n  filter(survey_cluster1 %in% miss) %&gt;% left_join(., missing) %&gt;% \n  arrange(survey_cluster1, dist_in_m) %&gt;% \n  select(survey_cluster1, urbanity,EACODE,ADM2_EN, dist_in_m, Se_raw) %&gt;% \n  group_by(survey_cluster1) %&gt;% \n  slice_min(dist_in_m, n=1)\n\n\n# A tibble: 4 × 6\n# Groups:   survey_cluster1 [4]\n  survey_cluster1 urbanity   EACODE ADM2_EN       dist_in_m  Se_raw\n            &lt;dbl&gt; &lt;fct&gt;       &lt;dbl&gt; &lt;chr&gt;             &lt;dbl&gt;   &lt;dbl&gt;\n1             200 2        31001098 Nsanje              570 0.327  \n2             276 2        30403066 Mulanje             250 0.0179 \n3             497 2        10402005 Rumphi             1870 0.00562\n4             777 1        20675001 Lilongwe City      4330 0.0609 \n\n\nWe decided to use the closest location with reference to the cluster because for this analysis the aggregation unit, and hence the reference point are the clusters. If we would allocate one value per EA (as for the other approaches) we should do the same for the whole sample, as mentioned above. As currently, we have only picked those EAs with observed values given that at least one value was available per EA, and trying, when possible, to avoid duplicated observed values.\nSome checks were performed to ensure that maize Se samples values were not duplicated.\n\n\nCode\npar(mfrow = c(1, 2))\nhist(maize_cluster$Se_mean)\nhist(maize_cluster$Se_sd)\n\n\n\n\n\n\n\n\n\n\n\n6.1.1.4 Limitations of the co-location at cluster-level\nThere were only five clusters where the closest samples and the cluster-EAs were not co-located (i.e., within the EA boundaries), as described in th previous section. Four of which were represented by only one sample point and most of them were at close distance and below the displacement distance (less than 2.5km). With the exception of Lilongwe city (cluster 777), for which the value of maize grain Se concentration used may not be representative due to a number of issue:\n\nRelated to the distance of the nearest sampling site: It was the longest distance between the cluster-EAs and the nearest maize sampling site. The distance was almost double the displacement for urban areas (2.5km vs 4.3km). This may be explained by the lack of agricultural fields (to grow maize) inside the city which was also confirm by local experts. According to personal communication with a local expert (G.O), the acquisition dynamics in the city are quite diverse, with people in the highest quintiles buying maize from supermarkets and/or bringing it from their hometowns, whereas those from middle and lowest quintiles may buy the maize in local market, local millers and/or own production, harvested from their family villages. There will be small family trades like bringing sugar and oil from the city to the home village and taking maize flour, particularly during harvest season. In addition, some climatic events that may affect crops and maize stocks (i.e., reduced stocks) in the lean season which in turn may affect the origin of the maize. For instance, this year (2023/2024) some of the maize distributed from aids (i.e., WFP) has been grown in Tanzania. Definitely more insights in local trades, and city food acquisition will be needed.\nRelated to the number of samples: In part, due to the distance to the nearest sample locations, we only have one maize grain Se concentration value for whole city, in addition, only one cluster was included in “Lilongwe city” as such, and hence the variation and representation it may be further hampered.\n\n\n\n\n6.1.2 District-level observed maize Se\nAll districts have sampled locations of the observed maize grain Se concentration. Hence, a number of approaches could have been taken to aggregate the observed maize values. For instance, in order to use the same values for both aggregation units, we could have used the dataset developed in the previous steps and using the EAs to identify which sampled points laid within each district. However, because values for 4 clusters were manually added by closest proximity, we will probably include duplicated values, unless we have exclude the samples where the distnace to the closest location was higher than 0m (indicating that sample was not within the EAs boundaries), and leading then to disparities between the cluster-level and district-level datasets. Hence, we decided to use the same approach as in the previous step, and spatially joint the districts boundaries and the geomaize.df.\nWe can see that, of the n=32, one district is missing: Likoma which we have no maize sample, but also no plasma samples were collected.\nOne thing is striking is that there are more maize samples per district when using the EA as opposed to the district boundaries, this is because of the duplication of values due to closest sample points. Despite that when plotting the two district-level datasets against each other, values were in agreement and closely aligned.\nTODO: Review further the sourve of disagreement between the number of samples by the two methods\n\n\n6.1.3 Buffer areas\nAll the aggregations for each buffer were performed using a loop, as we already identified that all buffers have at least one sampled value and the structure of the datasets were equal.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Methods: Data processing</span>"
    ]
  },
  {
    "objectID": "data-processing.html#sec-boundaries-pred",
    "href": "data-processing.html#sec-boundaries-pred",
    "title": "6  Methods: Data processing",
    "section": "6.2 Maize aggregation using predicted maize dataset",
    "text": "6.2 Maize aggregation using predicted maize dataset\nThe predicted maize had values for all the surface in Malawi, hence, no issues of missing values were found.\nThe process was the same as the observed, and it was done as described in previous sections.\n\n6.2.1 Buffer areas\nIn order to improve the reproducibility, code readability and transparency of the final model, we generated a function to obtain the buffers: buffer_generator().\nThe function takes as inputs the spatial dataset with the point location of the centroids and the ids of each centroid, in our case the cluster id, and the minimum and maximum buffer size and the increments in which should be generated.\nThe parameter were chosen as follow:\n\nmin: 10km buffer to be in line with the maximum displacement possible.\nmax: 60km based on the maximum district area.\nincrements: 10km based on the lag-bin chosen in the OK estimations.\n\nThe shapefiles generated for each buffer are stored in the folder. Then the folder was manually moved into the boundaries folder. This was needed because the st_write() can’t deal with long names. See GitHub issue.\n\n\nCode\n# Path to store the buffer generated below\nfolder &lt;- here::here( \"buffer\")\n\n# Function to generate buffers\n# smallest = 10km, biggest = 60km, increments = 10\nbuffer_generator(geogps, 10, 60, 10, folder)\n\n\nHere, in Figure 6.4 we can see the smallest buffer at 10km, followed by the maximum buffer at 60km.\n\n\nCode\n# Obtaining the distances for each buffer generated above\nbuff.dist &lt;- na.omit(unique(stringr::str_extract(list.files(here::here(\"data\", \n              \"inter-output\", \"boundaries\", \"buffer\")),\n                                        \"[:digit:]{2}\")))\n\n# Getting the smallest buffer from the buff.dist\ni = 1\n# Saving it for the map\nbuffer_min  &lt;- st_read(here::here(\"data\", \"inter-output\",\n                              \"boundaries\", \"buffer\",\n                              paste0(\"mwi_buffer\",buff.dist[i], \".shp\")), quiet = TRUE) \n\n# Plotting the map\ntm_shape(ea_admin) +\n  tm_polygons() +\n  tm_shape(buffer_min)+\n  tm_borders(col = \"red\") \n\n\n\n\n\n\n\n\nFigure 6.4: Map of Malawi with the red circles representing the smallest buffer (10km).\n\n\n\n\n\n\n\nCode\n# Getting the largest buffer from the buff.dist\ni = 6\n# Saving it for the map\nbuffer_max  &lt;- st_read(here::here(\"data\", \"inter-output\",\n                                  \"boundaries\", \"buffer\",\n                                  paste0(\"mwi_buffer\",buff.dist[i],\".shp\")), quiet = TRUE) \n\n# Plotting the map with the smallest and the largest buffers\ntm_shape(ea_admin) +\n  tm_polygons() +\n  tm_shape(buffer_min) +\n  tm_borders(col = \"red\") + \n  tm_shape(buffer_max)+\n  tm_borders(col = \"green\")\n\n\n\n\n\n\n\n\nFigure 6.5: Map of Malawi with the red circles representing the smallest buffer (10km) and the green circles representing the largest buffers (60km).\n\n\n\n\n\n\n\nCode\n# Getting the smallest buffer from the buff.dist\ntm_shape(ea_admin) +\n  tm_polygons() +\n  tm_shape(buffer_min)+\n  tm_borders(col = \"red\") \n\n# Plotting the map with the smallest and the largest buffers\ntm_shape(ea_admin) +\n  tm_polygons() +\n  tm_shape(buffer_min)+\n  tm_borders(col = \"red\") +\n  tm_shape(buffer_max)+\n  tm_borders(col = \"green\")\n\n\n\n\n\n\n\n\nFigure 6.6: Map of Malawi with the red circles representing the smallest buffer (10km).\n\n\n\n\n\n\n\n\n\n\n\nFigure 6.7: Map of Malawi with the red circles representing the smallest buffer (10km) and the green circles representing the largest buffers (60km).",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Methods: Data processing</span>"
    ]
  },
  {
    "objectID": "data-processing.html#joining-datasets",
    "href": "data-processing.html#joining-datasets",
    "title": "6  Methods: Data processing",
    "section": "6.3 Joining datasets",
    "text": "6.3 Joining datasets\nThe final step to get the dataset ready for modelling is to join the plasma.df dataset with the different values of maize Se for each of the aggregation level. That was perfomed in the script `` and it yielded 10 datasets: 5 aggregation levels (cluster, district, 15km, 25km and 30km buffer) x 2 maize Se values (observed, predicted).",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Methods: Data processing</span>"
    ]
  },
  {
    "objectID": "data-processing.html#limitation-of-the-data-aggregation",
    "href": "data-processing.html#limitation-of-the-data-aggregation",
    "title": "6  Methods: Data processing",
    "section": "6.4 Limitation of the data aggregation",
    "text": "6.4 Limitation of the data aggregation\nThe “co-location” issues were only problematic at the smallest area tested (e.g., cluster level) and for observed mean/median (that calculated using only the original sampled values). Hence, the concern when comparing with the predicted values will be:\nWhat are we really measuring/ comparing?\nAdditionally, it is important that we think about the displacement of the household location and the potential impacts on the final results. For instance, when two households are in the same EA, the maize Se value is the same for both households.\nSee sensitivity analysis.\nSome test were performed to check the influence of some of the decision/assumptions made during the data preparation and processing.\n\n6.4.1 Testing assumptions\n\n6.4.1.1 Sensitivity analysis\nWe compared the predicted mean/ median with the observed values of the same EA only. To see if the results of our analysis are actually measuring methodological differences (i.e., between normal aggregated mean and predicted mean), or on the contrary, the difference in spatial variation in maize Se values (i.e., there is a difference between choosing the nearest EAs and peaking the “actual” EAs).\n\n\n6.4.1.2 Household location\nThe coordinates for the HHs are only provided at cluster level (EAs). Hence, we need to check first the variability within cluster.\nWhen we checked the variability of Plasma Se by clusters (See ?fig-4), we have realised two key things:\n\nIn general, we could assume that there is “low” cluster variability in the Plasma Se.\nThere is high variability within regions, driven mainly by three clusters. As we can see by the scale of the plots in ?fig-4, in northern region the scale ranged from 50-150ng/mL, in central region from 0-300ng/mL, with the highest values for clusters within Salima district (as expected), and the southern region ranged from 50-250ng/mL.\n\n\n\n6.4.1.3 The variability of maize Se values by clusters\nSimilar trends were found for the individual clusters (Fig.1a-c), maize Se concentration values were comparable for all the aggregation levels with higher variability for specific clusters, particularly, where maize Se concentration was greater, as it can be seen for most of the clusters in the Northern district of Karonga (830, 507, 459, 388, 361, 309, 178), and in Salima (825, 209, 192, 170), or Ndanje (58, 200, 16) in the Central and Southern region, respectively. In the latter two regions, the largest values of maize Se concentration were found, as shown in Fig. 2, which corresponded to largest values in plasma Se concentration showing a comparable spatial pattern.\n\n\nCode\n## SM: Maize aggreg by cluster in paper-fig.R ----------------\n\n\n\nCo-location: combining datasets by location\nSamples, both maize and plasma, were supposed to be co-located (i.e., collected at the same EA) as per documentation on Gashu et al, (2021). However, when we checked the co-location of the two datasets: plasma Se values and the maize Se, based on the EAs where they were collected/ reported around 60% of our sample did not share the same EA. This was probably due to the EA displacement performed within the DHS protocol (see XX).\nHence, we decided to use the EAs where maize sample were collected (at the were not displaced), and to co-locate (by closest distance possible) the EAs within the buffer area displaced (2km and 5km for urban and rural respectively).\nEven when doing that, there were still two clusters (group of EAs) that did not have any maize grain Se value co-location. For those clusters, the closest EA (xx m) with maize grain Se values were used.\n\n\nDisplaced location EAs\nWe studied the distance between EA (based on the displaced GPS location) with plasma Se values, and the maize Se EAs. To do so, we added the distance (in m) at which the co-location was found, when we studied the distance for rural clusters, we can see that only one cluster, corresponding to n=8 WRA reported location, were within higher distance (&gt;5km) of the displacement. This corresponded to 1.23% of the sample of rural household which is below the reported, 10% displacement of 10km.\n\n\nMost probable EA\nFollowing the guidelines on the use of DHS GPS data, (Perez-Heydrich et al. (2013)), we assumed the missclassification potential, then we tested:\n\nidentify the most probable EA\ncompared that with the results above, i.e., with EAs were the same and which one were different\nchecked for those most probable which one had maize Se conc. and which one not\n\nThe list of the EAs where the WRA potentially lived was obtained in the scripts (00_cleaning-locations.R), and it was used to generate the centroids and buffers for further modelling in the 00_cleaning-boundaries.R.\n\n\n\n\nPerez-Heydrich, Carolina, Joshua L Warren, Clara R Burgert, and Michael Emch. 2013. Guidelines on the Use of DHS GPS Data. ICF International. https://dhsprogram.com/pubs/pdf/SAR8/SAR8.pdf.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Methods: Data processing</span>"
    ]
  },
  {
    "objectID": "maize-aggregation.html",
    "href": "maize-aggregation.html",
    "title": "7  Model preparation: Maize aggregation and data combination",
    "section": "",
    "text": "7.1 Data aggregation\nFor the final modelling we are only using predicted maize Se concentration to calculate the different level of aggregation. For more information on the reasons, see the section Model testing & calibration.\nThe file predmaize.df contains the coordinates of Malawi (lat/lon), the predicted maize Se concentration, both log-transformed (Zhat) and back transformed (Zhat_exp), and their covariance (uncertainty associated to each prediction) for each of the locations in Malawi.\nThe dataset was derived from the maize.df dataset using ordinary kriging and the scripts can be found in 01_maize-model.R and are based on the study of Gashu and colleagues (2022).\nThen, in order to calculate the mean/median value for each level of aggregation we will use the boundaries that were generated in the script (00_cleaning-location.R) and described in Section 3.1.\nHere we are proceeding as described in Section 6.2. In summary, to generate the final aggregations we are:\nCode\n# Converting into spatial object\ngeopredmaize.df &lt;-  st_as_sf( predmaize.df , coords =c(\"Longitude\", \"Latitude\"),\n                              crs = \"EPSG:4326\")\nCode\n### Cluster ----\n\n## Checking the EAs of the HHs with predicted maize\n\nbnd_reduced &lt;- ea_admin %&gt;% filter(EACODE %in% EAselected)\n\ngeopred_ea &lt;-  st_join(geopredmaize.df, bnd_reduced)\nCode\n# Calculating the maize grain Se conc per cluster\npredmaize_cluster &lt;- geopred_ea %&gt;% \n  st_drop_geometry() %&gt;% filter(!is.na(ADM2_EN)) %&gt;% \n  right_join(., cluster.df) %&gt;%  filter(!is.na(predSe)) %&gt;% \n  group_by(survey_cluster1) %&gt;% \n  summarise(Se_mean = mean(predSe, na.rm = TRUE), \n            Se_sd = sd(predSe, na.rm = TRUE), \n            Se_median = median(predSe, na.rm = TRUE), \n            Se_iqr = IQR(predSe, na.rm = TRUE), \n            Se_n = n())\nFor the buffers, it is performed equally but using a loop, that ingest the buffer generated and output the dataset with the maize Se mean for each buffer.\nCode\n# Getting the distances of the buffers\n\n(buff.dist &lt;- na.omit(unique(stringr::str_extract(list.files(here::here(\"data\", \n              \"inter-output\", \"boundaries\", \"buffer\")),\n                                        \"[:digit:]{2}\"))))\n\n#Saving unti a new object\ngeodata.df &lt;- geopredmaize.df\n\n# Getting the variable to perform the mean (calculations over)\nSe &lt;- grep(\"Se\", names(geodata.df), value = TRUE)\n\n# Looping over the buffers\nfor(i in 1:length(buff.dist)){\n  \n  buffer  &lt;- st_read(here::here(\"data\", \"inter-output\",\n                                \"boundaries\", \"buffer\",\n                                paste0(\"mwi_buffer\", buff.dist[i], \".shp\"))) %&gt;% \n    rename(survey_cluster1 = \"srvy_c1\")\n  \n  maize_buff &lt;- st_join(geodata.df, buffer) \n  \nif(sum(is.na(maize_buff[,Se]))&gt;0){\n  print(\"Error in the data merging\")\n}\n}\nHere’s an example of the output from the aggregated dataset.\nCode\ni = 1\n\nbuffer  &lt;- st_read(here::here(\"data\", \"inter-output\",\n                              \"boundaries\", \"buffer\",\n                              paste0(\"mwi_buffer\", buff.dist[i], \".shp\"))) %&gt;% \n  rename(survey_cluster1 = \"srvy_c1\")\n\n\nReading layer `mwi_buffer10' from data source \n  `C:\\Users\\LuciaSegoviaDeLaRevi\\OneDrive - London School of Hygiene and Tropical Medicine\\PhD\\PhD_r-project\\PhD_geospatial-modelling\\data\\inter-output\\boundaries\\buffer\\mwi_buffer10.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 102 features and 1 field\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 32.90714 ymin: -17.17541 xmax: 35.74069 ymax: -9.424538\nGeodetic CRS:  WGS 84\n\n\nCode\ndata.df &lt;- readRDS(here::here(\"data\", \"inter-output\",   \"aggregation\",  \n                              paste0(\"pred-maize-buffer\", \n                                     buff.dist[i], \"_v2.0.0.RDS\"))) %&gt;% \n  filter(!is.na(survey_cluster1))\n\ndata.df  &lt;- data.df %&gt;% left_join(., buffer) %&gt;% st_as_sf() \n\ntm_shape(ea_admin) +\n  tm_polygons() +\n  tm_shape(data.df)+\n  tm_polygons(fill = \"Se_mean\")",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Model preparation: Maize aggregation and data combination</span>"
    ]
  },
  {
    "objectID": "maize-aggregation.html#data-aggregation",
    "href": "maize-aggregation.html#data-aggregation",
    "title": "7  Model preparation: Maize aggregation and data combination",
    "section": "",
    "text": "Loading the boundaries for the administrative units (cluster-level and district-level) and the buffers which can be adapted using the function buffer_generator(), and are 10 km, 15 km, 20 km, 25 km, 30 km, 40 km, 50 km, 60 km. More information on that function can be found in Section 6.2.1.\nAfter selecting the aggregations, we need to get the information on the maize Se concentration for each aggregation area. To do so, we need to convert the predicted maize Se dataset (Long/Lat) into a spatial object (point locations).\n\n\n\nMerging the data by location. This spatial joint allowed us to obtain the maize Se concentration point data in each area. See ?fig-XX.\n\n\n\n\n\n\n\nNote\n\n\n\nBecause the dataset of the predicted maize is very large, and we only need the maize aggregation for the areas (e.g., EA group) were data on plasma Se were collected, we are using a shapefile with the cluster-level spatial data only for those EAs/clusters with plasma Se concentration collected.\n\n\n\n\nOnce we know for each maize Se concentration to which EA below, we can aggregate at cluster level (and district) (predmaize).\n\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nEach cluster has different size (different area), hence the number of maize Se data points varied accordingly.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Model preparation: Maize aggregation and data combination</span>"
    ]
  },
  {
    "objectID": "maize-aggregation.html#data-combination",
    "href": "maize-aggregation.html#data-combination",
    "title": "7  Model preparation: Maize aggregation and data combination",
    "section": "7.2 Data combination",
    "text": "7.2 Data combination\n\n\nCode\n# Maize Se conc. (from 01_maize-aggregation.R)\n(file &lt;- grep(\"pred-maize.*._v2\", list.files(here::here(\"data\", \"inter-output\", \"aggregation\")), \n     value = TRUE))\n\n\n [1] \"pred-maize-buffer10_v2.0.0.RDS\" \"pred-maize-buffer15_v2.0.0.RDS\"\n [3] \"pred-maize-buffer20_v2.0.0.RDS\" \"pred-maize-buffer25_v2.0.0.RDS\"\n [5] \"pred-maize-buffer30_v2.0.0.RDS\" \"pred-maize-buffer40_v2.0.0.RDS\"\n [7] \"pred-maize-buffer50_v2.0.0.RDS\" \"pred-maize-buffer60_v2.0.0.RDS\"\n [9] \"pred-maize-cluster_v2.0.0.RDS\"  \"pred-maize-district_v2.0.0.RDS\"\n[11] \"pred-maize-region_v2.0.0.RDS\"  \n\n\nHere, we are assigning the maize Se concentration, at the different level, to each WRA in each cluster (or district).\nFor all the datasets (n= 11), except for the district level, the linkage between the women and its corresponding maize Se concentration (i.e., the hypothetical concentration of Se that is likely to be supplied by maize) are based on the cluster id. This is because the buffer were generated based on the cluster centroids.\nFor ease of use, the datasets linkages are done using a loop (as outlined below), after which the datasets are ready to be used in the R-INLA model.\nThe final dataset contains the plasma Se concentration for women and all the covariates for the model, except for the distance to main lakes, which is merged in the next step.\n\n\nCode\n# Loop to generate a file with plasma data and maize with each aggregation unit\n\n# Run one for every file/aggegation\nfor(i in 1:length(file)){\n\n# Load the maize Se conc. aggregated dataset\nmaize.df &lt;- readRDS(here::here(\"data\", \"inter-output\", \"aggregation\", \n                              file[i]))\n\n# Join (left) plasma and maize datasets\n#based on common variable (eg cluster id)\ndata.df &lt;- left_join(plasma.df, maize.df) \n\n# Check if there are missing values for plasma Se conc.\nif(sum(is.na(data.df$selenium))&gt;0){\n  stop(paste0(\"Missing values in plamsa Se in \", file[i]))\n  \n}\n\n# Check if there are missing values for maize Se conc.\nif(sum(is.na(data.df$Se_mean))&gt;0){\n  stop(paste0(\"Missing values in maize Se in \", file[i]))\n  \n}\n\n# Save the output into the model folder\nsaveRDS(data.df, here::here(\"data\", \"inter-output\",   \"model\",  \n                      paste0(\"plasma-\", \n                             file[i])))\n\n}",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Model preparation: Maize aggregation and data combination</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "8  References",
    "section": "",
    "text": "Brathwaite, Rachel, Juliet Addo, Liam Smeeth, and Karen Lock. 2015.\n“A Systematic Review of Tobacco Smoking\nPrevalence and Description of Tobacco Control\nStrategies in Sub-Saharan African Countries; 2007 to\n2014.” PLOS ONE 10 (7): e0132401. https://doi.org/10.1371/journal.pone.0132401.\n\n\nChilimba, Allan D. C., Scott D. Young, Colin R. Black, Katie B.\nRogerson, E. Louise Ander, Michael J. Watts, Joachim Lammel, and Martin\nR. Broadley. 2011. “Maize Grain and Soil Surveys Reveal Suboptimal\nDietary Selenium Intake Is Widespread in Malawi.”\nScientific Reports 1 (1, 1): 72. https://doi.org/10.1038/srep00072.\n\n\nKadzamira, Mariam A. T. J., Harriet J. Gausi, and Tamara Phiri. 2021.\n“The Socio-Economic Impact of Disease Burden Due to Smoking in\nMalawi.”\n\n\nKumssa, D. B., A. W. Mossa, T. Amede, E. L. Ander, E. H. Bailey, L.\nBotoman, C. Chagumaira, et al. 2022. “Cereal Grain Mineral\nMicronutrient and Soil Chemistry Data from GeoNutrition\nSurveys in Ethiopia and Malawi.” Scientific Data 9 (1,\n1): 443. https://doi.org/10.1038/s41597-022-01500-5.\n\n\nLamarche, Céline, Maurizio Santoro, Sophie Bontemps, Raphaël\nd’Andrimont, Julien Radoux, Laura Giustarini, Carsten Brockmann, Jan\nWevers, Pierre Defourny, and Olivier Arino. 2017. “Compilation and\nValidation of SAR and Optical Data Products for a Complete and Global\nMap of Inland/Ocean Water Tailored to the Climate Modeling\nCommunity.” Remote Sensing 9 (1): 36.\n\n\n[Malawi], National Statistical Office (NSO), and ICF. 2017.\n“Malawi Demographic and Health Survey\n2015-16.” https://dhsprogram.com/pubs/pdf/FR319/FR319.pdf.\n\n\nPerez-Heydrich, Carolina, Joshua L Warren, Clara R Burgert, and Michael\nEmch. 2013. Guidelines on the Use of DHS GPS Data.\nICF International. https://dhsprogram.com/pubs/pdf/SAR8/SAR8.pdf.\n\n\nWebster, Richard, and Margaret A Oliver. 2007. Geostatistics for\nEnvironmental Scientists.",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>References</span>"
    ]
  }
]